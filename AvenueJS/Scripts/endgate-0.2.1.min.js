var EndGate;
(function(b){var f=function(){function b(a,c,e){"undefined"===typeof c&&(c=0);"undefined"===typeof e&&(e=0);this._type="TimeSpan";this.Milliseconds=a+c*b._secondsMultiplier+e*b._minutesMultiplier}Object.defineProperty(b.prototype,"Milliseconds",{get:function(){return this._milliseconds},set:function(a){this._milliseconds=a;this._seconds=a/b._secondsMultiplier;this._minutes=a/b._minutesMultiplier},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Seconds",{get:function(){return this._seconds},set:function(a){this._seconds=
a;this._milliseconds=a*b._secondsMultiplier;this._minutes=this._milliseconds/b._minutesMultiplier},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Minutes",{get:function(){return this._minutes},set:function(a){this._minutes=a;this._seconds=60*a;this._milliseconds=this._seconds*b._secondsMultiplier},enumerable:!0,configurable:!0});b.prototype.Add=function(a){return"TimeSpan"===a._type?new b(this.Milliseconds+a.Milliseconds):new b(this.Milliseconds+a)};b.prototype.Multiply=function(a){return"TimeSpan"===
a._type?new b(this.Milliseconds*a.Milliseconds):new b(this.Milliseconds*a)};b.prototype.Subtract=function(a){return"TimeSpan"===a._type?new b(this.Milliseconds-a.Milliseconds):new b(this.Milliseconds-a)};b.prototype.SubtractFrom=function(a){return"TimeSpan"===a._type?new b(a.Milliseconds-this.Milliseconds):new b(a-this.Milliseconds)};b.prototype.Divide=function(a){return"TimeSpan"===a._type?new b(this.Milliseconds/a.Milliseconds):new b(this.Milliseconds/a)};b.prototype.DivideFrom=function(a){return"TimeSpan"===
a._type?new b(a.Milliseconds/this.Milliseconds):new b(a/this.Milliseconds)};b.prototype.Equivalent=function(a){return this.Milliseconds===a.Milliseconds};b.prototype.Clone=function(){return new b(this.Milliseconds)};b.prototype.toString=function(){return this.Milliseconds+":"+this.Seconds+":"+this.Minutes};b.FromMilliseconds=function(a){return new b(a)};b.FromSeconds=function(a){return new b(0,a)};b.FromMinutes=function(a){return new b(0,0,a)};b.DateSpan=function(a,c){return new b(c.getTime()-a.getTime())};
Object.defineProperty(b,"Zero",{get:function(){return new b(0)},enumerable:!0,configurable:!0});b._secondsMultiplier=1E3;b._minutesMultiplier=60*b._secondsMultiplier;return b}();b.TimeSpan=f})(EndGate||(EndGate={}));
(function(b){var f=function(){function d(){this._type="GameTime";this._start=this._lastUpdate=new Date;this.Update()}Object.defineProperty(d.prototype,"Elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Now",{get:function(){return this._lastUpdate},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"Total",{get:function(){return b.TimeSpan.DateSpan(this._start,new Date)},enumerable:!0,configurable:!0});d.prototype.Update=
function(){var a=new Date;this._elapsed=new b.TimeSpan(a.getTime()-this._lastUpdate.getTime());this._lastUpdate=a};return d}();b.GameTime=f})(EndGate||(EndGate={}));
(function(b){var f=function(){function b(a,c){this._type="Size2d";this.Width=a||0;this.Height="undefined"!==typeof c?c:this.Width}Object.defineProperty(b,"Zero",{get:function(){return new b(0,0)},enumerable:!0,configurable:!0});Object.defineProperty(b,"One",{get:function(){return new b(1,1)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"Radius",{get:function(){return 0.5*Math.sqrt(this.Width*this.Width+this.Height*this.Height)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"HalfWidth",{get:function(){return this.Width/2},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"HalfHeight",{get:function(){return this.Height/2},enumerable:!0,configurable:!0});b.prototype.Apply=function(a){this.Width=a(this.Width);this.Height=a(this.Height)};b.prototype.Trigger=function(a){a(this.Width);a(this.Height)};b.prototype.Add=function(a){return"Size2d"===a._type?new b(this.Width+a.Width,this.Height+a.Height):"Vector2d"===a._type?new b(this.Width+a.X,this.Height+a.Y):
new b(this.Width+a,this.Height+a)};b.prototype.Multiply=function(a){return"Size2d"===a._type?new b(this.Width*a.Width,this.Height*a.Height):"Vector2d"===a._type?new b(this.Width*a.X,this.Height*a.Y):new b(this.Width*a,this.Height*a)};b.prototype.Subtract=function(a){return"Size2d"===a._type?new b(this.Width-a.Width,this.Height-a.Height):"Vector2d"===a._type?new b(this.Width-a.X,this.Height-a.Y):new b(this.Width-a,this.Height-a)};b.prototype.SubtractFrom=function(a){return"Size2d"===a._type?new b(a.Width-
this.Width,a.Height-this.Height):"Vector2d"===a._type?new b(a.X-this.Width,a.Y-this.Height):new b(a-this.Width,a-this.Height)};b.prototype.Divide=function(a){return"Size2d"===a._type?new b(this.Width/a.Width,this.Height/a.Height):"Vector2d"===a._type?new b(this.Width/a.X,this.Height/a.Y):new b(this.Width/a,this.Height/a)};b.prototype.DivideFrom=function(a){return"Size2d"===a._type?new b(a.Width/this.Width,a.Height/this.Height):"Vector2d"===a._type?new b(a.X/this.Width,a.Y/this.Height):new b(a/this.Width,
a/this.Height)};b.prototype.Negate=function(){return new b(-1*this.Width,-1*this.Height)};b.prototype.Equivalent=function(a){return this.Width===a.Width&&this.Height===a.Height};b.prototype.Clone=function(){return new b(this.Width,this.Height)};b.prototype.toString=function(){return"("+this.Width+", "+this.Height+")"};return b}();b.Size2d=f})(EndGate||(EndGate={}));Math.roundTo=function(b,f){var d=Math.pow(10,f);return Math.round(b*d)/d};Math.twoPI=2*Math.PI;
(function(b){var f=function(){function b(a,c){this._type="Vector2d";this.X=a||0;this.Y=c||0}Object.defineProperty(b,"Zero",{get:function(){return new b(0,0)},enumerable:!0,configurable:!0});Object.defineProperty(b,"One",{get:function(){return new b(1,1)},enumerable:!0,configurable:!0});b.prototype.Reflect=function(a){a=a.Unit();var c=2*this.Dot(a);return new b(this.X-c*a.X,this.Y-c*a.Y)};b.prototype.ProjectOnto=function(a){return a.Multiply(this.Dot(a)/a.Dot(a))};b.prototype.RotateAround=function(a,
c,e){"undefined"===typeof e&&(e=2);var n=Math.cos(c);c=Math.sin(c);return new b(Math.roundTo(n*(this.X-a.X)-c*(this.Y-a.Y)+a.X,e),Math.roundTo(c*(this.X-a.X)+n*(this.Y-a.Y)+a.Y,e))};b.prototype.Apply=function(a){this.X=a(this.X);this.Y=a(this.Y)};b.prototype.Trigger=function(a){a(this.X);a(this.Y)};b.prototype.Normalized=function(){var a=this.Magnitude();return new b(this.X/a,this.Y/a)};b.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)};b.prototype.Length=function(){return this.Magnitude()};
b.prototype.Dot=function(a){return a.X*this.X+a.Y*this.Y};b.prototype.Abs=function(){return new b(Math.abs(this.X),Math.abs(this.Y))};b.prototype.Sign=function(){return new b(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))};b.prototype.Unit=function(){var a=this.Magnitude();return new b(this.X/a,this.Y/a)};b.prototype.Distance=function(a){return new b(Math.abs(a.X-this.X),Math.abs(a.Y-this.Y))};b.prototype.Add=function(a){return"Vector2d"===a._type?new b(this.X+a.X,this.Y+a.Y):"Size2d"===a._type?
new b(this.X+a.Width,this.Y+a.Height):new b(this.X+a,this.Y+a)};b.prototype.Multiply=function(a){return"Vector2d"===a._type?new b(this.X*a.X,this.Y*a.Y):"Size2d"===a._type?new b(this.X*a.Width,this.Y*a.Height):new b(this.X*a,this.Y*a)};b.prototype.Subtract=function(a){return"Vector2d"===a._type?new b(this.X-a.X,this.Y-a.Y):"Size2d"===a._type?new b(this.X-a.Width,this.Y-a.Height):new b(this.X-a,this.Y-a)};b.prototype.SubtractFrom=function(a){return"Vector2d"===a._type?new b(a.X-this.X,a.Y-this.Y):
"Size2d"===a._type?new b(a.Width-this.X,a.Height=this.Y):new b(a-this.X,a-this.Y)};b.prototype.Divide=function(a){return"Vector2d"===a._type?new b(this.X/a.X,this.Y/a.Y):"Size2d"===a._type?new b(this.X/a.Width,this.Y/a.Height):new b(this.X/a,this.Y/a)};b.prototype.DivideFrom=function(a){return"Vector2d"===a._type?new b(a.X/this.X,a.Y/this.Y):"Size2d"===a._type?new b(a.Width/this.X,a.Height/this.Y):new b(a/this.X,a/this.Y)};b.prototype.IsZero=function(){return 0===this.X&&0===this.Y};b.prototype.Negate=
function(){return new b(-1*this.X,-1*this.Y)};b.prototype.Equivalent=function(a){return this.X===a.X&&this.Y===a.Y};b.prototype.Clone=function(){return new b(this.X,this.Y)};b.prototype.toString=function(){return"("+this.X+", "+this.Y+")"};return b}();b.Vector2d=f})(EndGate||(EndGate={}));
(function(b){(function(b){var d=function(){function a(a,e){this._boundsType="Bounds2d";this.Position=a;this.Rotation=e||0}a.prototype.Scale=function(a,e){throw Error("This method is abstract!");};a.prototype.ContainsPoint=function(a){throw Error("This method is abstract!");};a.prototype.ContainsCircle=function(a){throw Error("This method is abstract!");};a.prototype.ContainsRectangle=function(a){throw Error("This method is abstract!");};a.prototype.Contains=function(a){if("BoundingCircle"===a._boundsType)return this.ContainsCircle(a);
if("BoundingRectangle"===a._boundsType)return this.ContainsRectangle(a);if("Vector2d"===a._type)return this.ContainsPoint(a);throw Error("Cannot try and check contains with an unidentifiable object, must be a Vector2d, BoundingCircle or BoundingRectangle.");};a.prototype.Intersects=function(a){if("BoundingCircle"===a._boundsType)return this.IntersectsCircle(a);if("BoundingRectangle"===a._boundsType)return this.IntersectsRectangle(a);throw Error("Cannot intersect with unidentifiable object, must be BoundingCircle or BoundingRectangle.");
};a.prototype.IntersectsCircle=function(a){throw Error("This method is abstract!");};a.prototype.IntersectsRectangle=function(a){throw Error("This method is abstract!");};return a}();b.Bounds2d=d})(b.Bounds||(b.Bounds={}))})(EndGate||(EndGate={}));(function(b){(function(b){(function(b){var a=function(){function a(e){this._type="LooperCallback";this.Callback=e;this.ID=a._ids++}a._ids=0;return a}();b.LooperCallback=a})(b.Loopers||(b.Loopers={}))})(b._||(b._={}))})(EndGate||(EndGate={}));
var __extends=this.__extends||function(b,f){function d(){this.constructor=b}for(var a in f)f.hasOwnProperty(a)&&(b[a]=f[a]);d.prototype=f.prototype;b.prototype=new d};(function(b){(function(f){(function(d){var a=function(a){function e(e,b){a.call(this,b);this._type="TimedCallback";this.Fps=e;this.TimeoutID=0;this.Active=!1}__extends(e,a);return e}(b._.Loopers.LooperCallback);d.TimedCallback=a})(f.Loopers||(f.Loopers={}))})(b._||(b._={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){this._type="Looper";this._running=!1;this._callbacks=[]}a.prototype.AddCallback=function(a){var c=this;this._callbacks.push(a);a.Active=!0;this._running&&window.setTimeout(function(){c.Loop(a)},0)};a.prototype.RemoveCallback=function(a){for(var c=0;c<this._callbacks.length;c++)if(this._callbacks[c].ID===a.ID){window.clearTimeout(a.TimeoutID);a.Active=!1;this._callbacks.splice(c,1);break}};a.prototype.Start=function(){this._running=
!0;this.Run()};a.prototype.Run=function(){for(var a=this,c=0;c<this._callbacks.length;c++)window.setTimeout(function(c){return function(){a.Loop(a._callbacks[c])}}(c),0)};a.prototype.Loop=function(a){var c=this,b=1E3/a.Fps;a.Callback();a.Active&&(a.TimeoutID=window.setTimeout(function(){c.Loop(a)},b))};a.prototype.Dispose=function(){for(var a=this._callbacks.length-1;0<=a;a--)this.RemoveCallback(this._callbacks[a]);this._callbacks=[];this._running=!1};return a}();b.Looper=a})(b.Loopers||(b.Loopers=
{}))})(b._||(b._={}))})(EndGate||(EndGate={}));window.OnRepaintCompleted=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,0)};
(function(b){(function(b){(function(b){var a=function(){function a(){this._type="RepaintLooper";this._callbacksModified=this._running=!1;this._callbacks=[]}a.prototype.Start=function(){this._running=!0;this.Run()};a.prototype.Run=function(){var a=this;if(this._running){this._callbacksModified=!1;for(var c=0;c<this._callbacks.length&&(this._callbacks[c].Callback(),!this._callbacksModified);c++);window.OnRepaintCompleted(function(){a.Run()})}};a.prototype.AddCallback=function(a){this._callbacksModified=
!0;this._callbacks.push(a)};a.prototype.RemoveCallback=function(a){for(var c=0;c<this._callbacks.length;c++)if(this._callbacks[c].ID===a.ID){this._callbacksModified=!0;this._callbacks.splice(c,1);break}};a.prototype.Dispose=function(){this._callbacksModified=!0;this._callbacks=[];this._running=!1};return a}();b.RepaintLooper=a})(b.Loopers||(b.Loopers={}))})(b._||(b._={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(){this._type="GameRunner";this._updateCallbacks={};this._drawCallbacks={};this._drawLoop=this._updateLoop=null;this._callbackCount=0}a.prototype.Register=function(a){var e=this.CreateAndCacheUpdateCallback(a);a=this.CreateAndCacheDrawCallback(a);this._callbackCount++;this.TryLoopStart();this._updateLoop.AddCallback(e);this._drawLoop.AddCallback(a);return this.CreateUpdateRateSetter(e)};a.prototype.Unregister=function(a){var e,b;this._updateCallbacks[a._ID]&&
(e=this._updateCallbacks[a._ID],b=this._drawCallbacks[a._ID],this._updateLoop.RemoveCallback(e),this._drawLoop.RemoveCallback(b),delete this._updateCallbacks[a._ID],delete this._drawCallbacks[a._ID],this._callbackCount--,this.TryLoopStop())};a.prototype.TryLoopStart=function(){1===this._callbackCount&&(this._updateLoop=new b._.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new b._.Loopers.RepaintLooper,this._drawLoop.Start())};a.prototype.TryLoopStop=function(){0===this._callbackCount&&null!=
this._updateLoop&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)};a.prototype.CreateAndCacheUpdateCallback=function(a){var e=new b._.Loopers.TimedCallback(0,function(){a._PrepareUpdate()});return this._updateCallbacks[a._ID]=e};a.prototype.CreateAndCacheDrawCallback=function(a){var e=new b._.Loopers.LooperCallback(function(){a._PrepareDraw()});return this._drawCallbacks[a._ID]=e};a.prototype.CreateUpdateRateSetter=function(a){return function(e){a.Fps=
e}};return a}();f.GameRunner=d})(b._||(b._={}))})(EndGate||(EndGate={}));var GameRunnerInstance=new EndGate._.GameRunner;
(function(b){var f=function(){function b(){this._type="EventHandler";this._actions=[]}b.prototype.Bind=function(a){this._actions.push(a)};b.prototype.BindFor=function(a,c){var e=this,b=0,h=function(){++b>=c&&e.Unbind(h);a.apply(this,arguments)};this._actions.push(h)};b.prototype.Unbind=function(a){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===a){this._actions.splice(c,1);break}};b.prototype.HasBindings=function(){return 0<this._actions.length};b.prototype.Trigger=function(){var a;if(this.HasBindings()){a=
this._actions.slice(0);for(var c=0;c<a.length;c++)a[c]()}};b.prototype.Dispose=function(){this._actions=[]};return b}();b.EventHandler=f})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(c){this._initialQuadTreeSize=c;this._minQuadTreeNodeSize=a._DefaultMinQuadTreeNodeSize;this._OnChange=new b.EventHandler}Object.defineProperty(a.prototype,"MinQuadTreeNodeSize",{get:function(){return this._minQuadTreeNodeSize.Clone()},set:function(a){if(a.Width!==a.Height)throw Error("MinQuadTreeNodeSize must be a square.  Width and height must be identical.");this._minQuadTreeNodeSize=a;this._OnChange.Trigger()},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"InitialQuadTreeSize",{get:function(){return this._initialQuadTreeSize},set:function(a){if(a.Width!==a.Height)throw Error("InitialQuadTreeSize must be a square.  Width and height must be identical.");if(0!==a.Width%this._minQuadTreeNodeSize.Width)throw Error("InitialQuadTreeSize must be divisible by the MinQuadTreeNodeSize.");this._initialQuadTreeSize=a;this._OnChange.Trigger()},enumerable:!0,configurable:!0});a._DefaultMinQuadTreeNodeSize=new b.Size2d(32);return a}();
f.CollisionConfiguration=d})(b.Collision||(b.Collision={}))})(EndGate||(EndGate={}));
(function(b){var f=function(){function d(a,c){this._defaultUpdateRate=65;this.DrawOnlyAfterUpdate=!0;this._updateRateSetter=a;this.UpdateRate=this._defaultUpdateRate;this._collisionConfiguration=new b.Collision.CollisionConfiguration(c)}Object.defineProperty(d.prototype,"UpdateRate",{get:function(){return this._updateRate},set:function(a){this._updateRate=a;this._updateRateSetter(this._updateRate)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"CollisionConfiguration",{get:function(){return this._collisionConfiguration},
enumerable:!0,configurable:!0});return d}();b.GameConfiguration=f})(EndGate||(EndGate={}));(function(b){(function(b){var d=function(){return function(a,c){this.Min=a;this.Max=c}}();b.MinMax=d})(b._||(b._={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(){}a.GetMinMaxProjections=function(a,e){for(var n=e[0].ProjectOnto(a).Dot(a),h=n,g=1;g<e.length;g++){var d=e[g].ProjectOnto(a).Dot(a);d<n?n=d:d>h&&(h=d)}return new b._.MinMax(n,h)};return a}();f.Vector2dHelpers=d})(b._||(b._={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c){a.call(this,e);this._boundsType=this._type="BoundingCircle";this.Radius=c}__extends(c,a);c.prototype.Scale=function(a){this.Radius*=a};c.prototype.Area=function(){return Math.PI*this.Radius*this.Radius};c.prototype.Circumference=function(){return 2*Math.PI*this.Radius};c.prototype.IntersectsCircle=function(a){return this.Position.Distance(a.Position).Length()<this.Radius+a.Radius};c.prototype.IntersectsRectangle=function(a){var c=(0===a.Rotation?
this.Position:this.Position.RotateAround(a.Position,-a.Rotation)).Distance(a.Position);return c.X>a.Size.HalfWidth+this.Radius||c.Y>a.Size.HalfHeight+this.Radius?!1:c.X<=a.Size.HalfWidth||c.Y<=a.Size.HalfHeight?!0:Math.pow(c.X-a.Size.HalfWidth,2)+Math.pow(c.Y-a.Size.HalfHeight,2)<=this.Radius*this.Radius};c.prototype.ContainsPoint=function(a){return this.Position.Distance(a).Magnitude()<this.Radius};c.prototype.ContainsCircle=function(a){return a.Position.Distance(this.Position).Length()+a.Radius<=
this.Radius};c.prototype.ContainsRectangle=function(a){a=a.Corners();for(var c=0;c<a.length;c++)if(!this.ContainsPoint(a[c]))return!1;return!0};return c}(b.Bounds.Bounds2d);f.BoundingCircle=d})(b.Bounds||(b.Bounds={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c){a.call(this,e);this._boundsType=this._type="BoundingRectangle";this.Size=c}__extends(c,a);c.prototype.Scale=function(a,c){this.Size.Width*=a;this.Size.Height*=c};Object.defineProperty(c.prototype,"TopLeft",{get:function(){return 0===this.Rotation?new b.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):(new b.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight)).RotateAround(this.Position,
this.Rotation)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"TopRight",{get:function(){return 0===this.Rotation?new b.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):(new b.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotLeft",{get:function(){return 0===this.Rotation?new b.Vector2d(this.Position.X-
this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):(new b.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight)).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotRight",{get:function(){return 0===this.Rotation?new b.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):(new b.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight)).RotateAround(this.Position,
this.Rotation)},enumerable:!0,configurable:!0});c.prototype.Corners=function(){return[this.TopLeft,this.TopRight,this.BotLeft,this.BotRight]};c.prototype.IntersectsCircle=function(a){return a.IntersectsRectangle(this)};c.prototype.IntersectsRectangle=function(a){if(0===this.Rotation&&0===a.Rotation){var c=this.TopLeft,h=this.BotRight,g=a.TopLeft;a=a.BotRight;return g.X<=h.X&&a.X>=c.X&&g.Y<=h.Y&&a.Y>=c.Y}if(a.Position.Distance(this.Position).Magnitude()<=a.Size.Radius+this.Size.Radius){c=[this.TopRight.Subtract(this.TopLeft),
this.TopRight.Subtract(this.BotRight),a.TopLeft.Subtract(a.BotLeft),a.TopLeft.Subtract(a.TopRight)];h=this.Corners();a=a.Corners();for(g=0;g<c.length;g++){var d=c[g],f=b._.Vector2dHelpers.GetMinMaxProjections(d,h),d=b._.Vector2dHelpers.GetMinMaxProjections(d,a);if(d.Max<f.Min||f.Max<d.Min)return!1}return!0}return!1};c.prototype.ContainsPoint=function(a){var c=this.Rotation;0!==this.Rotation&&(this.Rotation=0,a=a.RotateAround(this.Position,-c));var b=this.TopLeft,g=this.BotRight;this.Rotation=c;return a.X<=
g.X&&a.X>=b.X&&a.Y<=g.Y&&a.Y>=b.Y};c.prototype.ContainsCircle=function(a){return this.ContainsPoint(new b.Vector2d(a.Position.X-a.Radius,a.Position.Y))&&this.ContainsPoint(new b.Vector2d(a.Position.X,a.Position.Y-a.Radius))&&this.ContainsPoint(new b.Vector2d(a.Position.X+a.Radius,a.Position.Y))&&this.ContainsPoint(new b.Vector2d(a.Position.X,a.Position.Y+a.Radius))};c.prototype.ContainsRectangle=function(a){a=a.Corners();for(var c=0;c<a.length;c++)if(!this.ContainsPoint(a[c]))return!1;return!0};return c}(b.Bounds.Bounds2d);
f.BoundingRectangle=d})(b.Bounds||(b.Bounds={}))})(EndGate||(EndGate={}));
(function(b){var f=function(){function b(){this._type="EventHandler1";this._actions=[]}b.prototype.Bind=function(a){this._actions.push(a)};b.prototype.BindFor=function(a,c){var e=this,b=0,h=function(){++b>=c&&e.Unbind(h);a.apply(this,arguments)};this._actions.push(h)};b.prototype.Unbind=function(a){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===a){this._actions.splice(c,1);break}};b.prototype.HasBindings=function(){return 0<this._actions.length};b.prototype.Trigger=function(a){var c;
if(this.HasBindings()){c=this._actions.slice(0);for(var e=0;e<c.length;e++)c[e](a)}};b.prototype.Dispose=function(){this._actions=[]};return b}();b.EventHandler1=f})(EndGate||(EndGate={}));(function(b){(function(b){var d=function(){return function(a){this.With=a}}();b.CollisionData=d})(b.Collision||(b.Collision={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(c){this._type="Collidable";this._disposed=!1;this.Bounds=c;this._id=a._collidableIDs++;this._onCollision=new b.EventHandler1;this._onDisposed=new b.EventHandler1}Object.defineProperty(a.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});a.prototype.IsCollidingWith=function(a){return this.Bounds.Intersects(a.Bounds)};
a.prototype.Collided=function(a){this.OnCollision.Trigger(a)};a.prototype.Dispose=function(){if(this._disposed)throw Error("Cannot dispose collidable more than once.");this._disposed=!0;this.OnDisposed.Trigger(this);this.OnDisposed.Dispose();this.OnCollision.Dispose()};a._collidableIDs=0;return a}();f.Collidable=d})(b.Collision||(b.Collision={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){(function(a){var c=function(a){function c(n,g,d,f){a.call(this,new b.Bounds.BoundingRectangle(n,g));this._minNodeSize=d;this._children=[];this.Contents=[];this.Parent=f;this._partitioned=!1}__extends(c,a);Object.defineProperty(c.prototype,"Children",{get:function(){return this._children},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"TopLeftChild",{get:function(){return this._children[0]},set:function(a){this._children[0]=a},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"TopRightChild",{get:function(){return this._children[1]},set:function(a){this._children[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotLeftChild",{get:function(){return this._children[2]},set:function(a){this._children[2]=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BotRightChild",{get:function(){return this._children[3]},set:function(a){this._children[3]=a},enumerable:!0,configurable:!0});c.prototype.IsPartitioned=
function(){return this._partitioned};c.prototype.Partition=function(){var a=new b.Size2d(Math.round(0.5*this.Bounds.Size.Width)),e=this.Bounds.Position;this._partitioned=!0;a.Width<this._minNodeSize.Width||(this._children.push(new c(e.Subtract(a.Multiply(0.5)),a,this._minNodeSize,this)),this._children.push(new c(new b.Vector2d(e.X+a.Width/2,e.Y-a.Height/2),a,this._minNodeSize,this)),this._children.push(new c(new b.Vector2d(e.X-a.Width/2,e.Y+a.Height/2),a,this._minNodeSize,this)),this._children.push(new c(e.Add(a.Multiply(0.5)),
a,this._minNodeSize,this)))};c.prototype.Insert=function(a){this._partitioned||this.Partition();for(var e=0;e<this._children.length;e++)if(this._children[e].Bounds.Contains(a.Bounds))return this._children[e].Insert(a);this.Contents.push(a);return this};c.prototype.ReverseInsert=function(a){return this.Bounds.Contains(a.Bounds)||null==this.Parent?this.Insert(a):this.Parent.ReverseInsert(a)};c.prototype.Query=function(a){for(var e=[],c,b=0;b<this.Contents.length;b++)a.Intersects(this.Contents[b].Bounds)&&
e.push(this.Contents[b]);for(b=0;b<this._children.length;b++){c=this._children[b];if(c.Bounds.Contains(a)){e=e.concat(c.Query(a));break}a.Contains(c.Bounds)?e=e.concat(c.GetSubTreeContents()):c.Bounds.Intersects(a)&&(e=e.concat(c.Query(a)))}return e};c.prototype.Remove=function(a){a=this.Contents.indexOf(a);0<=a&&this.Contents.splice(a,1)};c.prototype.GetSubTreeContents=function(){for(var a=[],e=0;e<this._children.length;e++)a=a.concat(this._children[e].GetSubTreeContents());return a=a.concat(this.Contents)};
return c}(b.Collision.Collidable);a.QuadTreeNode=c})(d._||(d._={}))})(f.Assets||(f.Assets={}))})(b.Collision||(b.Collision={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){(function(a){var c=function(){function a(e){this._disposed=!1;this._minNodeSize=e.MinQuadTreeNodeSize;this._collidableMap={};this._updateableCollidableMap={};this._root=new b.Collision.Assets._.QuadTreeNode(new b.Vector2d(e.InitialQuadTreeSize.HalfWidth,e.InitialQuadTreeSize.HalfHeight),e.InitialQuadTreeSize,e.MinQuadTreeNodeSize,null)}a.prototype.Insert=function(a,e){"undefined"===typeof e&&(e=!1);this._root.Bounds.Contains(a.Bounds)||this.Expand(a);this._collidableMap[a._id]=
{Node:this._root.Insert(a),Collidable:a,StaticPosition:e};e||(this._updateableCollidableMap[a._id]=this._collidableMap[a._id])};a.prototype.Remove=function(a){var e=this._collidableMap[a._id].Node;delete this._collidableMap[a._id];delete this._updateableCollidableMap[a._id];e.Remove(a)};a.prototype.CollisionCandidates=function(a){a=this._collidableMap[a._id].Node;for(var e=a.GetSubTreeContents();null!==a.Parent;)e=e.concat(a.Parent.Contents),a=a.Parent;return e};a.prototype.Query=function(a){return this._root.Query(a)};
a.prototype.Expand=function(a){var e=this._root.Bounds,c=e.TopLeft.Distance(a.Bounds.Position).Length(),d=e.TopRight.Distance(a.Bounds.Position).Length(),f=e.BotLeft.Distance(a.Bounds.Position).Length();a=e.BotRight.Distance(a.Bounds.Position).Length();var k=Math.min(c,d,f,a),l=e.Size.Multiply(2),m;k===c?(m=new b.Collision.Assets._.QuadTreeNode(e.TopLeft,l,this._minNodeSize,null),m.Partition(),m.BotRightChild=this._root):k===d?(m=new b.Collision.Assets._.QuadTreeNode(e.TopRight,l,this._minNodeSize,
null),m.Partition(),m.BotLeftChild=this._root):k===f?(m=new b.Collision.Assets._.QuadTreeNode(e.BotLeft,l,this._minNodeSize,null),m.Partition(),m.TopRightChild=this._root):k===a&&(m=new b.Collision.Assets._.QuadTreeNode(e.BotRight,l,this._minNodeSize,null),m.Partition(),m.TopLeftChild=this._root);this._root=this._root.Parent=m};a.prototype.Update=function(a){var e,c;for(c in this._updateableCollidableMap)e=this._updateableCollidableMap[c],a=e.Node,e=e.Collidable,a.Remove(e),this._root.Bounds.Contains(e.Bounds)?
a=a.Bounds.Contains(e.Bounds)||null==a.Parent?a.Insert(e):a.Parent.ReverseInsert(e):(this.Expand(e),a=this._root.Insert(e)),this._updateableCollidableMap[c].Node=a};a.prototype.Dispose=function(){if(this._disposed)throw Error("Cannot dispose collidable more than once.");this._disposed=!0};return a}();a.QuadTree=c})(d._||(d._={}))})(f.Assets||(f.Assets={}))})(b.Collision||(b.Collision={}))})(EndGate||(EndGate={}));
(function(b){var f=function(){function b(){this._type="EventHandler2";this._actions=[]}b.prototype.Bind=function(a){this._actions.push(a)};b.prototype.BindFor=function(a,c){var e=this,b=0,h=function(){++b>=c&&e.Unbind(h);a.apply(this,arguments)};this._actions.push(h)};b.prototype.Unbind=function(a){for(var c=0;c<this._actions.length;c++)if(this._actions[c]===a){this._actions.splice(c,1);break}};b.prototype.HasBindings=function(){return 0<this._actions.length};b.prototype.Trigger=function(a,c){var e;
if(this.HasBindings()){e=this._actions.slice(0);for(var b=0;b<e.length;b++)e[b](a,c)}};b.prototype.Dispose=function(){this._actions=[]};return b}();b.EventHandler2=f})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){this._type="CollisionManager";this._collidables=[];this._nonStaticCollidables=[];this._quadTree=new b.Collision.Assets._.QuadTree(a);this._disposed=this._enabled=!1;this._onCollision=new b.EventHandler2}Object.defineProperty(a.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0});a.prototype.Monitor=function(a,e){"undefined"===typeof e&&(e=!1);var b=this,h={Collidable:a,Unmonitor:function(a){b.Unmonitor(a)}};
this._enabled=!0;a.OnDisposed.Bind(h.Unmonitor);this._collidables.push(h);e||this._nonStaticCollidables.push(a);this._quadTree.Insert(a)};a.prototype.Unmonitor=function(a){var e;for(e=0;e<this._collidables.length;e++)if(this._collidables[e].Collidable._id===a._id){this._collidables[e].Collidable.OnDisposed.Unbind(this._collidables[e].Unmonitor);this._collidables.splice(e,1);break}e=this._nonStaticCollidables.indexOf(a);0<=e&&this._nonStaticCollidables.splice(e,1);this._quadTree.Remove(a)};a.prototype.Update=
function(a){var e,n,h={},g=[];if(this._enabled){this._quadTree.Update(a);for(a=0;a<this._nonStaticCollidables.length;a++){e=this._nonStaticCollidables[a];n=this._quadTree.CollisionCandidates(e);for(var d=0;d<n.length;d++)e._id!==n[d]._id&&e.IsCollidingWith(n[d])&&g.push([e,n[d]])}for(a=0;a<g.length;a++)e=this.HashIds(g[a][0],g[a][1]),h[e]||(h[e]=!0,g[a][0].Collided(new b.Collision.CollisionData(g[a][1])),g[a][1].Collided(new b.Collision.CollisionData(g[a][0])),this.OnCollision.Trigger(g[a][0],g[a][1]))}};
a.prototype.Dispose=function(){if(this._disposed)throw Error("CollisionManager cannot be disposed more than once");this._disposed=!0;for(var a=0;a<this._collidables.length;a++)this.Unmonitor(this._collidables[a].Collidable);this._collidables=[];this._nonStaticCollidables=[];this._onCollision.Dispose();this._quadTree=null};a.prototype.HashIds=function(a,e){return Math.min(a._id,e._id).toString()+Math.max(e._id,a._id).toString()};return a}();f.CollisionManager=d})(b.Collision||(b.Collision={}))})(EndGate||
(EndGate={}));
(function(b){(function(b){(function(b){(function(a){var c=function(){function a(){this._cachedState={}}Object.defineProperty(a.prototype,"StrokeStyle",{get:function(){return this._cachedState.strokeStyle},set:function(a){this._cachedState.strokeStyle=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"FillStyle",{get:function(){return this._cachedState.fillStyle},set:function(a){this._cachedState.fillStyle=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"GlobalAlpha",
{get:function(){return this._cachedState.globalAlpha},set:function(a){this._cachedState.globalAlpha=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"LineWidth",{get:function(){return this._cachedState.lineWidth},set:function(a){this._cachedState.lineWidth=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"LineCap",{get:function(){return this._cachedState.lineCap},set:function(a){this._cachedState.lineCap=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"LineJoin",{get:function(){return this._cachedState.lineJoin},set:function(a){this._cachedState.lineJoin=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"MiterLimit",{get:function(){return this._cachedState.miterLimit},set:function(a){this._cachedState.miterLimit=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ShadowOffsetX",{get:function(){return this._cachedState.shadowOffsetX},set:function(a){this._cachedState.shadowOffsetX=a},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"ShadowOffsetY",{get:function(){return this._cachedState.shadowOffsetY},set:function(a){this._cachedState.shadowOffsetY=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ShadowBlur",{get:function(){return this._cachedState.shadowBlur},set:function(a){this._cachedState.shadowBlur=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ShadowColor",{get:function(){return this._cachedState.shadowColor},set:function(a){this._cachedState.shadowColor=
a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"GlobalCompositeOperation",{get:function(){return this._cachedState.globalCompositeOperation},set:function(a){this._cachedState.globalCompositeOperation=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Font",{get:function(){return this._cachedState.font},set:function(a){this._cachedState.font=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"TextAlign",{get:function(){return this._cachedState.textAlign},
set:function(a){this._cachedState.textAlign=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"TextBaseline",{get:function(){return this._cachedState.textBaseline},set:function(a){this._cachedState.textBaseline=a},enumerable:!0,configurable:!0});a.prototype.SetContextState=function(a){for(var e in this._cachedState)a[e]=this._cachedState[e]};return a}();a.Graphic2dState=c})(b._||(b._={}))})(b.Assets||(b.Assets={}))})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){this._type="Graphic2d";this.Position=a;this.ZIndex=this.Rotation=0;this.Visible=!0;this._State=new b.Graphics.Assets._.Graphic2dState;this.Opacity=1;this._children=[];this._childrenRemovalBindings=[];this.Parent=null;this._disposed=!1;this._onDisposed=new b.EventHandler1}Object.defineProperty(a.prototype,"AbsolutePosition",{get:function(){for(var a=this.Position,e=this;e=e.Parent;)a=a.Add(e.Position);return a},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(a){this._State.GlobalAlpha=a},enumerable:!0,configurable:!0});a.prototype.GetChildren=function(){return this._children.slice(0)};a.prototype.AddChild=function(c){var e=this,b;if(null!==c.Parent)throw Error("Graphic already has parent, cannot add it as a child.");b=function(a){e.RemoveChild(a)};
c.Parent=this;c.OnDisposed.Bind(b);this._children.push(c);this._childrenRemovalBindings.push(b);this._children.sort(a._zindexSort)};a.prototype.RemoveChild=function(a){a=this._children.indexOf(a);return 0<=a?(this._children[a].Parent=null,this._children[a].OnDisposed.Unbind(this._childrenRemovalBindings[a]),this._children.splice(a,1),this._childrenRemovalBindings.splice(a,1),!0):!1};a.prototype._StartDraw=function(a){a.save();this._State.SetContextState(a);a.translate(this.Position.X,this.Position.Y);
0!==this.Rotation&&a.rotate(this.Rotation)};a.prototype._EndDraw=function(a){for(var e=0;e<this._children.length;e++)this._children[e].Visible&&this._children[e].Draw(a);a.restore()};a.prototype.Draw=function(a){throw Error("The Draw method is abstract on Graphic2d and should not be called.");};a.prototype.GetDrawBounds=function(){throw Error("GetDrawBounds is abstract, it must be implemented.");};a.prototype.Scale=function(a){throw Error("Scale is abstract, it must be implemented.");};a.prototype.Clone=
function(){throw Error("Clone is abstract, it must be implemented.");};a.prototype._Clone=function(a){for(var e=0;e<this._children.length;e++)a.AddChild(this._children[e].Clone());a.Opacity=this.Opacity;a.Rotation=this.Rotation;a.Visible=this.Visible;a.ZIndex=this.ZIndex};a.prototype.Dispose=function(){var a;if(this._disposed)throw Error("Cannot dispose graphic more than once.");this._disposed=!0;a=this._children.slice(0);for(var e=0;e<a.length;e++)a[e].Dispose();this._children=null;this.OnDisposed.Trigger(this);
this.OnDisposed.Dispose()};a._zindexSort=function(a,e){return a.ZIndex-e.ZIndex};return a}();f.Graphic2d=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,b){a.call(this,e,b);this._type="Camera2d";this.Distance=c.DefaultDistance}__extends(c,a);c.prototype.ToCameraRelative=function(a){return this.Position.Subtract(this.Size.Multiply(0.5*this._GetDistanceScale())).Add(a.Multiply(this._GetDistanceScale()))};c.prototype._GetInverseDistanceScale=function(){return c.DefaultDistance/this.Distance};c.prototype._GetDistanceScale=function(){return this.Distance/c.DefaultDistance};c.DefaultDistance=1E3;
return c}(b.Bounds.BoundingRectangle);f.Camera2d=d})(b.Rendering||(b.Rendering={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){this._visibleCanvas=a;this._visibleContext=a.getContext("2d");this._BufferCanvas=document.createElement("canvas");this._BufferContext=this._BufferCanvas.getContext("2d");this._onRendererSizeChange=new b.EventHandler1;this.UpdateBufferSize();this._disposed=!1}Object.defineProperty(a.prototype,"OnRendererSizeChange",{get:function(){return this._onRendererSizeChange},enumerable:!0,configurable:!0});a.prototype.Render=function(c){this._BufferCanvas.width===
this._visibleCanvas.width&&this._BufferCanvas.height===this._visibleCanvas.height||this.UpdateBufferSize();this._visibleContext.clearRect(0,0,this._visibleCanvas.width,this._visibleCanvas.height);this._visibleContext.drawImage(this._BufferCanvas,0,0);this._ClearBuffer();c.sort(a._zindexSort);for(var e=0;e<c.length;e++)c[e].Draw(this._BufferContext);return this._BufferContext};a.prototype.Dispose=function(){this._disposed||(this._disposed=!0,this._visibleCanvas.parentNode.removeChild(this._visibleCanvas),
this._onRendererSizeChange.Dispose())};a.prototype._ClearBuffer=function(){this._BufferContext.clearRect(0,0,this._BufferCanvas.width,this._BufferCanvas.height)};a.prototype.UpdateBufferSize=function(){this._BufferCanvas.width=this._visibleCanvas.width;this._BufferCanvas.height=this._visibleCanvas.height;this.OnRendererSizeChange.Trigger(new b.Size2d(this._visibleCanvas.width,this._visibleCanvas.height))};a._zindexSort=function(a,e){return a.ZIndex-e.ZIndex};return a}();f.Renderer2d=d})(b.Rendering||
(b.Rendering={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(e){this._camera=e;this._canvasCenter=this._camera.Position.Clone();this._translated=!1;this._translationState=[];this._translationState.push(this._translated)}a.prototype.Build=function(a){var c=this,b=a.createRadialGradient,g=a.translate,d=a.save,f=a.restore,k=this.BuildPositionReplacer(a.drawImage,1),l=this.BuildPositionReplacer(a.drawImage,5);a.unModifiedClearRect=a.clearRect;a.arc=this.BuildPositionReplacer(a.arc);a.arcTo=this.BuildPositionReplacer(a.arcTo,
0,4);a.bezierCurveTo=this.BuildPositionReplacer(a.bezierCurveTo,0,6);a.clearRect=this.BuildPositionReplacer(a.clearRect);a.createLinearGradient=this.BuildPositionReplacer(a.createLinearGradient,0,4);a.createRadialGradient=function(){var a=c._camera._GetDistanceScale();arguments[0]+=-c._camera.Position.X+c._canvasCenter.X*a;arguments[1]+=-c._camera.Position.Y+c._canvasCenter.Y*a;arguments[3]+=-c._camera.Position.X+c._canvasCenter.X*a;arguments[4]+=-c._camera.Position.Y+c._canvasCenter.Y*a;return b.apply(this,
arguments)};a.drawImage=function(){5>=arguments.length?k.apply(this,arguments):l.apply(this,arguments)};a.fillRect=this.BuildPositionReplacer(a.fillRect);a.fillText=this.BuildPositionReplacer(a.fillText,1);a.getImageData=this.BuildPositionReplacer(a.getImageData);a.isPointInPath=this.BuildPositionReplacer(a.isPointInPath);a.lineTo=this.BuildPositionReplacer(a.lineTo);a.moveTo=this.BuildPositionReplacer(a.moveTo);a.putImageData=this.BuildPositionReplacer(a.putImageData,1);a.quadraticCurveTo=this.BuildPositionReplacer(a.quadraticCurveTo,
0,4);a.rect=this.BuildPositionReplacer(a.rect);a.strokeRect=this.BuildPositionReplacer(a.strokeRect);a.strokeText=this.BuildPositionReplacer(a.strokeText,1);a.save=function(){c._translationState.push(c._translated);d.call(this)};a.restore=function(){c._translated=c._translationState.pop();f.call(this)};a.translate=function(){var a;c._translated||(a=c._camera._GetDistanceScale(),arguments[0]+=-c._camera.Position.X+c._canvasCenter.X*a,arguments[1]+=-c._camera.Position.Y+c._canvasCenter.Y*a);c._translated=
!0;g.apply(this,arguments)};return a};a.prototype._UpdateCanvasCenter=function(a){this._canvasCenter.X=a.Width/2;this._canvasCenter.Y=a.Height/2};a.prototype.BuildPositionReplacer=function(a,c,b){"undefined"===typeof c&&(c=0);"undefined"===typeof b&&(b=2);var g=this,d=["X","Y"];return function(){var f,k;if(!g._translated){f=g._camera._GetDistanceScale();for(var l=0;l<b;l++)k=d[l%2],arguments[c+l]+=-g._camera.Position[k]+g._canvasCenter[k]*f}return a.apply(this,arguments)}};return a}();b.Camera2dCanvasContextBuilder=
a})(b._||(b._={}))})(b.Rendering||(b.Rendering={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c){var h=this;a.call(this,e);this._camera=c;this._contextBuilder=new b.Rendering._.Camera2dCanvasContextBuilder(this._camera);this.OnRendererSizeChange.Bind(function(a){h._contextBuilder._UpdateCanvasCenter(a);h._camera.Size=a});this._contextBuilder._UpdateCanvasCenter(new b.Size2d(e.width,e.height));this._BufferContext=this._contextBuilder.Build(this._BufferContext)}__extends(c,a);c.prototype.Render=function(e){var c=this._camera._GetInverseDistanceScale();
this._BufferContext.save();this._BufferContext.scale(c,c);e=a.prototype.Render.call(this,this.GetOnScreenRenderables(e));this._BufferContext.restore();return e};c.prototype._ClearBuffer=function(){var a=this._camera._GetDistanceScale();this._BufferContext.unModifiedClearRect(0,0,this._BufferCanvas.width*a,this._BufferCanvas.height*a)};c.prototype.GetOnScreenRenderables=function(a){var c=[],b=this._camera._GetDistanceScale(),g=1/b;this._camera.Scale(b,b);for(b=0;b<a.length;b++)a[b].Visible&&this._camera.Intersects(a[b].GetDrawBounds())&&
c.push(a[b]);this._camera.Scale(g,g);return c};return c}(b.Rendering.Renderer2d);f.Camera2dRenderer=d})(b.Rendering||(b.Rendering={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,e){"undefined"===typeof a&&(a=function(a){});this._actorMappings=[];this._actors=[];"undefined"===typeof e&&(e=this.CreateDefaultDrawArea());this._onDraw=a;this._drawArea=e;this._camera=new b.Rendering.Camera2d(new b.Vector2d(this._drawArea.width/2,this._drawArea.height/2),new b.Size2d(this._drawArea.width,this._drawArea.height));this._renderer=new b.Rendering.Camera2dRenderer(this._drawArea,this._camera);this._disposed=!1}Object.defineProperty(a.prototype,
"DrawArea",{get:function(){return this._drawArea},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});a.prototype.Add=function(a){var e=this,b={Actor:a,Remove:function(a){e.Remove(a)}};a.OnDisposed.Bind(b.Remove);this._actorMappings.push(b);this._actors.push(a)};a.prototype.Remove=function(a){for(var e=0;e<this._actors.length;e++)if(this._actors[e]===a){this._actors[e].OnDisposed.Unbind(this._actorMappings[e].Remove);
this._actors.splice(e,1);this._actorMappings.splice(e,1);break}};a.prototype.Draw=function(){this._onDraw(this._renderer.Render(this._actors))};a.prototype.Dispose=function(){if(this._disposed)throw Error("Scene2d cannot be disposed more than once");this._disposed=!0;for(var a=0;a<this._actors.length;a++)this.Remove(this._actors[a]);this._actors=[];this._actorMappings=[];this._renderer.Dispose()};a.prototype.CreateDefaultDrawArea=function(){var a=document.createElement("canvas"),e=document.getElementsByTagName("body")[0];
a.width=document.documentElement.clientWidth;a.height=document.documentElement.clientHeight-5;e.appendChild(a);e.style.margin="0px";e.style.padding="0px";return a};return a}();f.Scene2d=d})(b.Rendering||(b.Rendering={}))})(EndGate||(EndGate={}));(function(b){(function(b){(function(b){var a=function(){function a(){}a.Left="Left";a.Middle="Middle";a.Right="Right";return a}();b.MouseButton=a})(b._||(b._={}))})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){var e=this;this._target=a;this._disposed=!1;this._onClick=new b.EventHandler1;this._onDoubleClick=new b.EventHandler1;this._onDown=new b.EventHandler1;this._onUp=new b.EventHandler1;this._onMove=new b.EventHandler1;this._onScroll=new b.EventHandler1;this._rightIsDown=this._middleIsDown=this._leftIsDown=!1;this.Wire();this.OnDown.Bind(function(a){e._isDown=!0;e[a.Button+"IsDown"]=!0;window.focus()});this.OnUp.Bind(function(a){e._isDown=!1;e[a.Button+
"IsDown"]=!1;window.focus()});this.OnClick.Bind(function(a){window.focus()});this.OnDoubleClick.Bind(function(a){window.focus()})}Object.defineProperty(a.prototype,"LeftIsDown",{get:function(){return this._leftIsDown},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"MiddleIsDown",{get:function(){return this._middleIsDown},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"RightIsDown",{get:function(){return this._rightIsDown},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"IsDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnClick",{get:function(){return this._onClick},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnDoubleClick",{get:function(){return this._onDoubleClick},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnDown",{get:function(){return this._onDown},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnUp",{get:function(){return this._onUp},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnMove",{get:function(){return this._onMove},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnScroll",{get:function(){return this._onScroll},enumerable:!0,configurable:!0});a.prototype.Dispose=function(){if(this._disposed)throw Error("MouseHandler cannot be disposed more than once");this._disposed=!0;this._onClick.Dispose();this._onDoubleClick.Dispose();this._onDown.Dispose();this._onMove.Dispose();this._onScroll.Dispose();
this._onUp.Dispose();this.Unwire();this._target=null};a.prototype.Wire=function(){var a=this;this._clickWire=this._contextMenuWire=this.BuildEvent(this._onClick,this.BuildMouseClickEvent);this._dblClickWire=this.BuildEvent(this._onDoubleClick,this.BuildMouseClickEvent);this._mouseDownWire=this.BuildEvent(this._onDown,this.BuildMouseClickEvent);this._mouseUpWire=this.BuildEvent(this._onUp,this.BuildMouseClickEvent);this._mouseMoveWire=this.BuildEvent(this._onMove,this.BuildMouseEvent);/MSIE/i.test(navigator.userAgent)||
/Trident/i.test(navigator.userAgent)?(this._mouseWheelWireName="wheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(e){e.wheelDeltaX=-e.deltaX;e.wheelDeltaY=-e.deltaY;return a.BuildMouseScrollEvent(e)})):/Firefox/i.test(navigator.userAgent)?(this._mouseWheelWireName="DOMMouseScroll",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(e){e.wheelDeltaX=1===e.axis?-e.detail:0;e.wheelDeltaY=2===e.axis?-e.detail:0;return a.BuildMouseScrollEvent(e)})):(this._mouseWheelWireName=
"mousewheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,this.BuildMouseScrollEvent));this._target.addEventListener("click",this._clickWire,!1);this._target.addEventListener("contextmenu",this._contextMenuWire,!1);this._target.addEventListener("dblclick",this._dblClickWire,!1);this._target.addEventListener("mousedown",this._mouseDownWire,!1);this._target.addEventListener("mouseup",this._mouseUpWire,!1);this._target.addEventListener("mousemove",this._mouseMoveWire,!1);this._target.addEventListener(this._mouseWheelWireName,
this._mouseWheelWire,!1)};a.prototype.Unwire=function(){this._target.removeEventListener("click",this._clickWire,!1);this._target.removeEventListener("contextmenu",this._contextMenuWire,!1);this._target.removeEventListener("dblclick",this._dblClickWire,!1);this._target.removeEventListener("mousedown",this._mouseDownWire,!1);this._target.removeEventListener("mouseup",this._mouseUpWire,!1);this._target.removeEventListener("mousemove",this._mouseMoveWire,!1);this._target.removeEventListener(this._mouseWheelWireName,
this._mouseWheelWire,!1)};a.prototype.BuildEvent=function(a,e,b){"undefined"===typeof b&&(b=!1);var h=this;return function(g){a.HasBindings()&&a.Trigger(e.call(h,g));g.preventDefault();return b}};a.prototype.BuildMouseScrollEvent=function(a){return{Position:this.GetMousePosition(a),Direction:this.GetMouseScrollDierction(a)}};a.prototype.BuildMouseEvent=function(a){return{Position:this.GetMousePosition(a)}};a.prototype.BuildMouseClickEvent=function(a){return{Position:this.GetMousePosition(a),Button:this.GetMouseButton(a)}};
a.prototype.GetMousePosition=function(a){return new b.Vector2d(a.offsetX?a.offsetX:a.pageX-this._target.offsetLeft,a.offsetY?a.offsetY:a.pageY-this._target.offsetTop)};a.prototype.GetMouseButton=function(c){return c.which?a.MouseButtonArray[c.which]:b.Input._.MouseButton.Right};a.prototype.GetMouseScrollDierction=function(a){return new b.Vector2d(-Math.max(-1,Math.min(1,a.wheelDeltaX)),-Math.max(-1,Math.min(1,a.wheelDeltaY)))};a.MouseButtonArray=[null,b.Input._.MouseButton.Left,b.Input._.MouseButton.Middle,
b.Input._.MouseButton.Right];return a}();f.MouseHandler=d})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(e,b){"undefined"===typeof b&&(b=!1);this._invoker=a._noop;this._action=e;b&&this.Trip()}a.prototype.Invoke=function(){for(var a=[],b=0;b<arguments.length-0;b++)a[b]=arguments[b+0];this._invoker.apply(this,a)};a.prototype.InvokeOnce=function(){for(var a=[],b=0;b<arguments.length-0;b++)a[b]=arguments[b+0];this._invoker.apply(this,a);this.Reset()};a.prototype.Trip=function(){this._invoker=this._action};a.prototype.Reset=function(){this._invoker=
a._noop};a._noop=function(){};return a}();b.NoopTripInvoker=a})(b.Utilities||(b.Utilities={}))})(b._||(b._={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(e,b,c){this.Ctrl=e;this.Alt=b;this.Shift=c}a.prototype.Equivalent=function(a){return this.Ctrl===a.Ctrl&&this.Alt===a.Alt&&this.Shift===a.Shift};a.BuildFromCommandString=function(e){var b=0<=e.toLowerCase().indexOf("ctrl+")?!0:!1,h=0<=e.toLowerCase().indexOf("alt+")?!0:!1;e=0<=e.toLowerCase().indexOf("shift+")?!0:!1;return new a(b,h,e)};return a}();b.KeyboardModifiers=a})(b.Assets||(b.Assets={}))})(b.Input||(b.Input={}))})(EndGate||
(EndGate={}));
(function(b){(function(b){var d=function(){function a(a){this._element=a;this._id=this._element.id;this._classes=Array.prototype.slice.call(this._element.classList);this._tag=this._element.tagName}Object.defineProperty(a.prototype,"Id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Classes",{get:function(){return this._classes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Element",{get:function(){return this._element},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"Tag",{get:function(){return this._tag},enumerable:!0,configurable:!0});return a}();b.KeyboardEventTarget=d})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={27:"esc",9:"tab",32:"space",13:"return",8:"backspace",45:"insert",36:"home",46:"delete",35:"end",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},c=function(){function e(e){var c,g;this.Modifiers=new b.Input.Assets.KeyboardModifiers(e.ctrlKey,
e.altKey,e.shiftKey);e.keyCode?c=e.keyCode:e.which&&(c=e.which);(g=String.fromCharCode(e.keyCode))===e.key||(g=a[c])||(g=String.fromCharCode(c).toLowerCase(),this.Modifiers.Shift&&d[g]&&(g=d[g]));this.Key=g;this.Target=new b.Input.KeyboardEventTarget(e.target)}e.prototype.Matches=function(a){return this.Key.toLowerCase()===a.Key.toLowerCase()&&a.Modifiers.Equivalent(this.Modifiers)};return e}();f.KeyboardCommandEvent=c})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}a.ParseKey=function(a){a=a.split("+");return 1<a.length?a[a.length-1]:a[0]};return a}();b.KeyboardCommandHelper=a})(b._||(b._={}))})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){var a=function(){function a(e,c){var h=this;this.Action=c;this.Modifiers=b.Input.Assets.KeyboardModifiers.BuildFromCommandString(e);this.Key=b.Input._.KeyboardCommandHelper.ParseKey(e);this._onDisposed=new b.EventHandler;this._onDisposeInvoker=new b._.Utilities.NoopTripInvoker(function(){h._onDisposed.Trigger()},!0)}Object.defineProperty(a.prototype,"OnDispose",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0});a.prototype.Dispose=function(){this._onDisposeInvoker.InvokeOnce()};
return a}();d.KeyboardCommand=a})(f.Assets||(f.Assets={}))})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(){this._onPressCommands={};this._onDownCommands={};this._onUpCommands={};this._onKeyPress=new b.EventHandler1;this._onKeyDown=new b.EventHandler1;this._onKeyUp=new b.EventHandler1;this._disposed=!1;this.Wire()}Object.defineProperty(a.prototype,"OnKeyPress",{get:function(){return this._onKeyPress},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnKeyDown",{get:function(){return this._onKeyDown},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"OnKeyUp",{get:function(){return this._onKeyUp},enumerable:!0,configurable:!0});a.prototype.OnCommandPress=function(a,e){return this.UpdateCache(a,e,this._onPressCommands)};a.prototype.OnCommandDown=function(a,e){return this.UpdateCache(a,e,this._onDownCommands)};a.prototype.OnCommandUp=function(a,e){return this.UpdateCache(a,e,this._onUpCommands)};a.prototype.Dispose=function(){if(this._disposed)throw Error("KeyboardHandler cannot be disposed more than once");this._disposed=
!0;this._onKeyDown.Dispose();this._onKeyPress.Dispose();this._onKeyUp.Dispose();for(var a in this._onDownCommands)this._onDownCommands[a].Dispose();this._onDownCommands=null;for(a in this._onUpCommands)this._onUpCommands[a].Dispose();this._onUpCommands=null;for(a in this._onPressCommands)this._onPressCommands[a].Dispose();this._onPressCommands=null;this.Unwire()};a.prototype.UpdateCache=function(c,e,n){c=new b.Input.Assets.KeyboardCommand(c,e);var h=a._keyboardCommandIds++;c.OnDispose.Bind(function(){delete n[h]});
return n[h]=c};a.prototype.Wire=function(){this._keyPressWire=this.BuildKeyEvent(this._onPressCommands,this.OnKeyPress);this._keyDownWire=this.BuildKeyEvent(this._onDownCommands,this.OnKeyDown);this._keyUpWire=this.BuildKeyEvent(this._onUpCommands,this.OnKeyUp);document.addEventListener("keypress",this._keyPressWire,!1);document.addEventListener("keydown",this._keyDownWire,!1);document.addEventListener("keyup",this._keyUpWire,!1)};a.prototype.Unwire=function(){document.removeEventListener("keypress",
this._keyPressWire,!1);document.removeEventListener("keydown",this._keyDownWire,!1);document.removeEventListener("keyup",this._keyUpWire,!1)};a.prototype.BuildKeyEvent=function(a,e){return function(n){var h,g=!0;h=new b.Input.KeyboardCommandEvent(n);e.Trigger(h);for(var d in a)h.Matches(a[d])&&(a[d].Action(),n.preventDefault(),g=!1);return g}};a._keyboardCommandIds=0;return a}();f.KeyboardHandler=d})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){this._disposed=!1;this.Mouse=new b.Input.MouseHandler(a);this.Keyboard=new b.Input.KeyboardHandler}a.prototype.Dispose=function(){if(this._disposed)throw Error("MouseHandler cannot be disposed more than once");this._disposed=!0;this.Mouse.Dispose();this.Keyboard.Dispose()};return a}();f.InputManager=d})(b.Input||(b.Input={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,e,n,h,g,d,f){"undefined"===typeof h&&(h=0);"undefined"===typeof g&&(g=0);"undefined"===typeof d&&(d=e);"undefined"===typeof f&&(f=n);var k=this,l="undefined"!==typeof e;this._onLoaded=new b.EventHandler1;"string"===typeof a?(this._loaded=!1,this.Source=new Image,this._loadWire=function(a){k._loaded=!0;l||(k._size=new b.Size2d(k.Source.width,k.Source.height),k.ClipLocation=b.Vector2d.Zero,k.ClipSize=k._size.Clone());k._onLoaded.Trigger(k)},this._imageLocation=
this.Source.src=a,l?(this._size=new b.Size2d(e,n),this.ClipLocation=new b.Vector2d(h,g),this.ClipSize=new b.Size2d(d,f)):this.ClipSize=null):(d=h,f=g,h=e,g=n,this.Source=a,this._imageLocation=a.src,this._loaded=!1,this.Source.complete?(this._loadWire=function(a){k._loaded=!0;k._onLoaded.Trigger(k)},this._size=new b.Size2d(a.width,a.height)):this._loadWire=function(e){k._loaded=!0;k._onLoaded.Trigger(k);k._size=new b.Size2d(a.width,a.height)},this.ClipLocation=new b.Vector2d(h,g),this.ClipSize=new b.Size2d(d,
f));this.Source.complete?setTimeout(this._loadWire,0):this.Source.addEventListener("load",this._loadWire,!1)}Object.defineProperty(a.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0});a.prototype.IsLoaded=function(){return this._loaded};a.prototype.Extract=function(b,e,n,h){return new a(this._imageLocation,this._size.Width,this._size.Height,b,
e,n,h)};a.prototype.Dispose=function(){this.Source.removeEventListener("load",this._loadWire);this.Source=null;this._onLoaded.Dispose()};a.prototype.Clone=function(){return this.ClipSize?new a(this.Source,this.ClipLocation.X,this.ClipLocation.Y,this.ClipSize.Width,this.ClipSize.Height):new a(this.Source)};return a}();f.ImageSource=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(b){var d=function(){function a(a,e,b,h){"undefined"===typeof a&&(a=!1);"undefined"===typeof e&&(e=100);"undefined"===typeof b&&(b=!1);"undefined"===typeof h&&(h="auto");this.Repeat=a;this.Volume=e;this.AutoPlay=b;this.Preload=h}a.prototype.Clone=function(){return new a(this.Repeat,this.Volume,this.AutoPlay,this.Preload)};a.Default=new a;return a}();b.AudioSettings=d})(b.Sound||(b.Sound={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},a=function(){function a(e,c){"undefined"===typeof c&&(c=b.Sound.AudioSettings.Default);this._disposed=!1;this._settings=c.Clone();this._canPlayWires=[];e instanceof HTMLAudioElement?this._audio=e:(this._audio=document.createElement("audio"),this.SetAudioSource(e));this.ApplySettings();this._onComplete=new b.EventHandler1}Object.defineProperty(a.prototype,"OnComplete",{get:function(){return this._onComplete},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Volume",{get:function(){return this._settings.Volume},set:function(a){this._settings.Volume=a;this._audio.volume=Math.max(Math.min(a/100,1),0)},enumerable:!0,configurable:!0});a.prototype.IsPlaying=function(){return!this._audio.paused};a.prototype.IsComplete=function(){return this._audio.ended};a.prototype.Play=function(){var a=this,b;0===this._audio.readyState?(b=function(){a._audio.play()},this._canPlayWires.push(b),this._audio.addEventListener("canplay",
b,!0)):this._audio.play()};a.prototype.Pause=function(){this._audio.pause()};a.prototype.Seek=function(a){var b=this,c;0===this._audio.readyState?(c=function(){b._audio.currentTime=a},this._canPlayWires.push(c),this._audio.addEventListener("canplay",c,!0)):this._audio.currentTime=a};a.prototype.Stop=function(){this.Seek(0);this._audio.pause()};a.prototype.Dispose=function(){if(this._disposed)throw Error("Cannot dispose AudioClip more than once.");this._disposed=!0;this._onComplete.Dispose();for(var a=
0;a<this._canPlayWires.length;a++)this._audio.removeEventListener("canplay",this._canPlayWires[a],!0);this._audio.removeEventListener("ended",this._endedWire,!0);this._settings=this._audio=null};a.prototype.SetAudioSource=function(a){var b,c;a instanceof Array||(a=[a]);for(var g=0;g<a.length;g++)b=document.createElement("source"),b.src=a[g],c=d[a[g].split(".").pop()],"undefined"!==typeof c&&(b.type=c),this._audio.appendChild(b)};a.prototype.ApplySettings=function(){var a=this;this._audio.loop=this._settings.Repeat;
this._audio.autoplay=this._settings.AutoPlay;this._audio.preload=this._settings.Preload;this.Volume=this._settings.Volume;this._endedWire=function(b){a.OnComplete.Trigger(b)};this._audio.addEventListener("ended",this._endedWire,!0)};return a}();f.AudioClip=a})(b.Sound||(b.Sound={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){a instanceof Array?this._source=a:(this._source=[],this._source.push(a))}a.prototype.BuildClip=function(a){"undefined"===typeof a&&(a=b.Sound.AudioSettings.Default);return new b.Sound.AudioClip(this._source,a)};a.prototype.Play=function(a){"undefined"===typeof a&&(a=b.Sound.AudioSettings.Default);a=new b.Sound.AudioClip(this._source,a);a.Play();return a};return a}();f.AudioPlayer=d})(b.Sound||(b.Sound={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(){this._images={};this._audioPlayers={}}a.prototype.LoadImage=function(a,e,n,h){e=new b.Graphics.ImageSource(e,n,h);this._images[a]=e;return e.Clone()};a.prototype.GetImage=function(a){if(this._images[a])return this._images[a].Clone();throw Error("Image with name '"+a+"' was not found.");};a.prototype.UnloadImage=function(a){return this._images[a]?(delete this._images[a],!0):!1};a.prototype.LoadAudio=function(a,e){this._audioPlayers[a]=new b.Sound.AudioPlayer(e);
return this._audioPlayers[a]};a.prototype.GetAudio=function(a){if(this._audioPlayers[a])return this._audioPlayers[a];throw Error("Audio with name '"+a+"' was not found.");};a.prototype.UnloadAudio=function(a){var b=this._audioPlayers[a];delete this._audioPlayers[a];return b};return a}();f.ContentManager=d})(b.Content||(b.Content={}))})(EndGate||(EndGate={}));
(function(b){var f=function(){function d(a){var c=this;this._type="Game";var e=b.Collision.CollisionConfiguration._DefaultMinQuadTreeNodeSize;this._updateRequired=!0;this._gameTime=new b.GameTime;this._ID=d._gameIds++;this.Scene=new b.Rendering.Scene2d(function(a){c.Draw(a)},a);this.Input=new b.Input.InputManager(this.Scene.DrawArea);this.Content=new b.Content.ContentManager;a=this.Scene.Camera.Size;0!==a.Width%e.Width&&(a=new b.Size2d(a.Width%e.Width+a.Width));this.Configuration=new b.GameConfiguration(GameRunnerInstance.Register(this),
a);this.CollisionManager=new b.Collision.CollisionManager(this.Configuration.CollisionConfiguration);this.Configuration.CollisionConfiguration._OnChange.Bind(function(){c.CollisionManager=new b.Collision.CollisionManager(c.Configuration.CollisionConfiguration)});this._PrepareLoadContent()}d.prototype._PrepareUpdate=function(){this._gameTime.Update();this.Update(this._gameTime);this.CollisionManager.Update(this._gameTime);this._updateRequired=!1};d.prototype._PrepareLoadContent=function(){this.LoadContent()};
d.prototype.LoadContent=function(){};d.prototype.Update=function(a){};d.prototype._PrepareDraw=function(){this.Configuration.DrawOnlyAfterUpdate&&this._updateRequired||(this.Scene.Draw(),this._updateRequired=!0)};d.prototype.Draw=function(a){};d.prototype.Dispose=function(){this.Scene.Dispose();this.CollisionManager.Dispose();this.Input.Dispose();GameRunnerInstance.Unregister(this)};d._gameIds=0;return d}();b.Game=f})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,e,n,h){this._from=a.Clone();this._to=e.Clone();this._current=this._from.Clone();this._duration=n;this._elapsed=b.TimeSpan.Zero;this._playing=!1;this._onChange=new b.EventHandler1;this._onComplete=new b.EventHandler1;this._tweeningFunction=h}Object.defineProperty(a.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnComplete",{get:function(){return this._onComplete},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"From",{get:function(){return this._from},set:function(a){this._from=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"To",{get:function(){return this._to},set:function(a){this._to=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Current",{get:function(){return this._current},set:function(a){this._current=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Duration",{get:function(){return this._duration},
set:function(a){this._duration=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Elapsed",{get:function(){return this._elapsed.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"TweeningFunction",{get:function(){return this._tweeningFunction},set:function(a){this._tweeningFunction=a},enumerable:!0,configurable:!0});a.prototype.IsPlaying=function(){return this._playing};a.prototype.Play=function(){this._playing=!0};a.prototype.Pause=function(){this._playing=
!1};a.prototype.Reset=function(){this._elapsed.Milliseconds=0;this._current=this._from.Clone()};a.prototype.Stop=function(){this._playing=!1;this.Reset()};a.prototype.Restart=function(){this.Reset();this.Play()};a.prototype.Reverse=function(){this._elapsed=b.TimeSpan.Zero;this._to=this._from;this._from=this.Current.Clone()};a.prototype.Update=function(a){this._playing&&(this._elapsed=this._elapsed.Add(a.Elapsed),this._elapsed.Milliseconds>=this._duration.Milliseconds?(this._elapsed=this._duration.Clone(),
this._current=this._to.Clone(),this._playing=!1,this._onChange.Trigger(this._current.Clone()),this._onComplete.Trigger(this)):(this._UpdateTween(),this._onChange.Trigger(this._current.Clone())))};a.prototype.Dispose=function(){this.Stop();this._onChange.Dispose();this._onComplete.Dispose()};a.prototype._UpdateTween=function(){};return a}();f.Tween=d})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseNone",{get:function(){return a._easeNone},enumerable:!0,configurable:!0});a._easeNone=function(a,b,c,g){return(b-a)*c.Milliseconds/g.Milliseconds+a};return a}();b.Linear=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));Number.prototype.Clone=function(){return this};function asyncLoop(b,f,d){(function c(e){e<f?b(function(){c(e+1)},e):d&&d()})(0)}
(function(b){(function(f){var d=function(){function a(a,e,n,h){this._type="Color";this._cached=void 0;this._onChange=new b.EventHandler1;"string"===typeof a&&0<a.length?this.InitializeColorFromString(a):(this.A=void 0===h?1:h,this.R=a,this.G=e,this.B=n)}Object.defineProperty(a.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"R",{get:function(){return this._r},set:function(a){this._cached=void 0;this._r=Math.round(Math.min(Math.max(a,
0),255));this._onChange.Trigger(this)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"G",{get:function(){return this._g},set:function(a){this._cached=void 0;this._g=Math.round(Math.min(Math.max(a,0),255));this._onChange.Trigger(this)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"B",{get:function(){return this._b},set:function(a){this._cached=void 0;this._b=Math.round(Math.min(Math.max(a,0),255));this._onChange.Trigger(this)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"A",{get:function(){return this._a},set:function(a){this._cached=void 0;this._a=Math.min(Math.max(a,0),1);this._onChange.Trigger(this)},enumerable:!0,configurable:!0});a.FromRGB=function(b,e,n){return new a(b,e,n)};a.FromRGBA=function(b,e,n,h){return new a(b,e,n,h)};a.FromARGB=function(b,e,n,h){return new a(e,n,h,b)};a.FromHex=function(b){return new a(b)};a.FromName=function(b){return new a(b)};a.ConvertShortHexToLong=function(b){3===b.length&&(b+="f");4===b.length&&
(b=b.replace(a.RgbaHexRegExp,function(a,b,c,g,d){return c+c+g+g+d+d+b+b}));return b};a.prototype.InitializeColorFromString=function(a){a=this.NamedColorToHex(a);var b=null,b="string"===typeof a?this.CreateColorObjectFromString(a):a;this.A=b.A;this.B=b.B;this.R=b.R;this.G=b.G};a.prototype.CreateColorObjectFromString=function(b){"#"===b.charAt(0)&&(b=b.substr(1));b=a.ConvertShortHexToLong(b);6===b.length&&(b+="ff");return 8===b.length?this.ParseAlphaHex(b):this.ParseRGB(b)};a.prototype.ParseRGB=function(b){if(b=
a.RgbRegExp.exec(b))switch(b[1]){case "rgb":return new a(parseInt(b[2]),parseInt(b[3]),parseInt(b[4]));case "argb":return new a(parseInt(b[3]),parseInt(b[4]),parseInt(b[5]),parseFloat(b[2]));case "rgba":return new a(parseInt(b[2]),parseInt(b[3]),parseInt(b[4]),parseFloat(b[5]))}return a.Magenta};a.prototype.ParseAlphaHex=function(b){var e,n,h;e=parseInt(b.charAt(0)+b.charAt(1),16);n=parseInt(b.charAt(2)+b.charAt(3),16);h=parseInt(b.charAt(4)+b.charAt(5),16);b=parseInt(b.charAt(6)+b.charAt(7),16)/
255;return new a(e,n,h,b)};a.prototype.ParseHex=function(b){var e,n;e=parseInt(b.charAt(0)+b.charAt(1),16);n=parseInt(b.charAt(2)+b.charAt(3),16);b=parseInt(b.charAt(4)+b.charAt(5),16);return new a(e,n,b)};a.prototype.NamedColorToHex=function(b){return"#"===b.substring(0,1)?b:"undefined"!==typeof a._namedColors[b.toLowerCase()]?a._namedColors[b.toLowerCase()]:b};Object.defineProperty(a,"Transparent",{get:function(){return a._namedColors.transparent.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"AliceBlue",{get:function(){return a._namedColors.aliceblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"AntiqueWhite",{get:function(){return a._namedColors.antiquewhite.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Aqua",{get:function(){return a._namedColors.aqua.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Aquamarine",{get:function(){return a._namedColors.aquamarine.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Azure",
{get:function(){return a._namedColors.azure.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Beige",{get:function(){return a._namedColors.beige.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Bisque",{get:function(){return a._namedColors.bisque.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Black",{get:function(){return a._namedColors.black.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"BlanchedAlmond",{get:function(){return a._namedColors.blanchedalmond.Clone()},
enumerable:!0,configurable:!0});Object.defineProperty(a,"Blue",{get:function(){return a._namedColors.blue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"BlueViolet",{get:function(){return a._namedColors.blueviolet.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Brown",{get:function(){return a._namedColors.brown.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"BurlyWood",{get:function(){return a._namedColors.burlywood.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"CadetBlue",{get:function(){return a._namedColors.cadetblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Chartreuse",{get:function(){return a._namedColors.chartreuse.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Chocolate",{get:function(){return a._namedColors.chocolate.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Coral",{get:function(){return a._namedColors.coral.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"CornflowerBlue",{get:function(){return a._namedColors.cornflowerblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Cornsilk",{get:function(){return a._namedColors.cornsilk.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Crimson",{get:function(){return a._namedColors.crimson.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Cyan",{get:function(){return a._namedColors.cyan.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkBlue",
{get:function(){return a._namedColors.darkblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkCyan",{get:function(){return a._namedColors.darkcyan.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkGoldenRod",{get:function(){return a._namedColors.darkgoldenrod.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkGray",{get:function(){return a._namedColors.darkgray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkGreen",
{get:function(){return a._namedColors.darkgreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkKhaki",{get:function(){return a._namedColors.darkkhaki.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkMagenta",{get:function(){return a._namedColors.darkmagenta.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkOliveGreen",{get:function(){return a._namedColors.darkolivegreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"DarkOrange",{get:function(){return a._namedColors.darkorange.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkOrchid",{get:function(){return a._namedColors.darkorchid.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkRed",{get:function(){return a._namedColors.darkred.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkSalmon",{get:function(){return a._namedColors.darksalmon.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"DarkSeaGreen",{get:function(){return a._namedColors.darkseagreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkSlateBlue",{get:function(){return a._namedColors.darkslateblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkSlateGray",{get:function(){return a._namedColors.darkslategray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DarkTurquoise",{get:function(){return a._namedColors.darkturquoise.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"DarkViolet",{get:function(){return a._namedColors.darkviolet.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DeepPink",{get:function(){return a._namedColors.deeppink.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DeepSkyBlue",{get:function(){return a._namedColors.deepskyblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"DimGray",{get:function(){return a._namedColors.dimgray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"DodgerBlue",{get:function(){return a._namedColors.dodgerblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"FireBrick",{get:function(){return a._namedColors.firebrick.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"FloralWhite",{get:function(){return a._namedColors.floralwhite.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"ForestGreen",{get:function(){return a._namedColors.forestgreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"Fuchsia",{get:function(){return a._namedColors.fuchsia.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Gainsboro",{get:function(){return a._namedColors.gainsboro.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"GhostWhite",{get:function(){return a._namedColors.ghostwhite.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Gold",{get:function(){return a._namedColors.gold.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"GoldenRod",{get:function(){return a._namedColors.goldenrod.Clone()},
enumerable:!0,configurable:!0});Object.defineProperty(a,"Gray",{get:function(){return a._namedColors.gray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Green",{get:function(){return a._namedColors.green.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"GreenYellow",{get:function(){return a._namedColors.greenyellow.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"HoneyDew",{get:function(){return a._namedColors.honeydew.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"HotPink",{get:function(){return a._namedColors.hotpink.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"IndianRed",{get:function(){return a._namedColors.indianred.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Indigo",{get:function(){return a._namedColors.indigo.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Ivory",{get:function(){return a._namedColors.ivory.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"Khaki",{get:function(){return a._namedColors.khaki.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Lavender",{get:function(){return a._namedColors.lavender.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LavenderBlush",{get:function(){return a._namedColors.lavenderblush.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LawnGreen",{get:function(){return a._namedColors.lawngreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LemonChiffon",
{get:function(){return a._namedColors.lemonchiffon.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightBlue",{get:function(){return a._namedColors.lightblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightCoral",{get:function(){return a._namedColors.lightcoral.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightCyan",{get:function(){return a._namedColors.lightcyan.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightGoldenRodYellow",
{get:function(){return a._namedColors.lightgoldenrodyellow.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightGray",{get:function(){return a._namedColors.lightgray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightGrey",{get:function(){return a._namedColors.lightgrey.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightGreen",{get:function(){return a._namedColors.lightgreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"LightPink",{get:function(){return a._namedColors.lightpink.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightSalmon",{get:function(){return a._namedColors.lightsalmon.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightSeaGreen",{get:function(){return a._namedColors.lightseagreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightSkyBlue",{get:function(){return a._namedColors.lightskyblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"LightSlateGray",{get:function(){return a._namedColors.lightslategray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightSteelBlue",{get:function(){return a._namedColors.lightsteelblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"LightYellow",{get:function(){return a._namedColors.lightyellow.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Lime",{get:function(){return a._namedColors.lime.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"LimeGreen",{get:function(){return a._namedColors.limegreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Linen",{get:function(){return a._namedColors.linen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Magenta",{get:function(){return a._namedColors.magenta.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Maroon",{get:function(){return a._namedColors.maroon.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumAquaMarine",
{get:function(){return a._namedColors.mediumaquamarine.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumBlue",{get:function(){return a._namedColors.mediumblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumOrchid",{get:function(){return a._namedColors.mediumorchid.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumPurple",{get:function(){return a._namedColors.mediumpurple.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"MediumSeaGreen",{get:function(){return a._namedColors.mediumseagreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumSlateBlue",{get:function(){return a._namedColors.mediumslateblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumSpringGreen",{get:function(){return a._namedColors.mediumspringgreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MediumTurquoise",{get:function(){return a._namedColors.mediumturquoise.Clone()},enumerable:!0,
configurable:!0});Object.defineProperty(a,"MediumVioletRed",{get:function(){return a._namedColors.mediumvioletred.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MidnightBlue",{get:function(){return a._namedColors.midnightblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MintCream",{get:function(){return a._namedColors.mintcream.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"MistyRose",{get:function(){return a._namedColors.mistyrose.Clone()},
enumerable:!0,configurable:!0});Object.defineProperty(a,"Moccasin",{get:function(){return a._namedColors.moccasin.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"NavajoWhite",{get:function(){return a._namedColors.navajowhite.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Navy",{get:function(){return a._namedColors.navy.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"OldLace",{get:function(){return a._namedColors.oldlace.Clone()},enumerable:!0,
configurable:!0});Object.defineProperty(a,"Olive",{get:function(){return a._namedColors.olive.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"OliveDrab",{get:function(){return a._namedColors.olivedrab.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Orange",{get:function(){return a._namedColors.orange.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"OrangeRed",{get:function(){return a._namedColors.orangered.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"Orchid",{get:function(){return a._namedColors.orchid.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PaleGoldenRod",{get:function(){return a._namedColors.palegoldenrod.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PaleGreen",{get:function(){return a._namedColors.palegreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PaleTurquoise",{get:function(){return a._namedColors.paleturquoise.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"PaleVioletRed",{get:function(){return a._namedColors.palevioletred.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PapayaWhip",{get:function(){return a._namedColors.papayawhip.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PeachPuff",{get:function(){return a._namedColors.peachpuff.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Peru",{get:function(){return a._namedColors.peru.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"Pink",{get:function(){return a._namedColors.pink.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Plum",{get:function(){return a._namedColors.plum.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"PowderBlue",{get:function(){return a._namedColors.powderblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Purple",{get:function(){return a._namedColors.purple.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Red",{get:function(){return a._namedColors.red.Clone()},
enumerable:!0,configurable:!0});Object.defineProperty(a,"RosyBrown",{get:function(){return a._namedColors.rosybrown.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"RoyalBlue",{get:function(){return a._namedColors.royalblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SaddleBrown",{get:function(){return a._namedColors.saddlebrown.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Salmon",{get:function(){return a._namedColors.salmon.Clone()},enumerable:!0,
configurable:!0});Object.defineProperty(a,"SandyBrown",{get:function(){return a._namedColors.sandybrown.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SeaGreen",{get:function(){return a._namedColors.seagreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SeaShell",{get:function(){return a._namedColors.seashell.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Sienna",{get:function(){return a._namedColors.sienna.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"Silver",{get:function(){return a._namedColors.silver.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SkyBlue",{get:function(){return a._namedColors.skyblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SlateBlue",{get:function(){return a._namedColors.slateblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SlateGray",{get:function(){return a._namedColors.slategray.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"Snow",{get:function(){return a._namedColors.snow.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SpringGreen",{get:function(){return a._namedColors.springgreen.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"SteelBlue",{get:function(){return a._namedColors.steelblue.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Tan",{get:function(){return a._namedColors.tan.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Teal",{get:function(){return a._namedColors.teal.Clone()},
enumerable:!0,configurable:!0});Object.defineProperty(a,"Thistle",{get:function(){return a._namedColors.thistle.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Tomato",{get:function(){return a._namedColors.tomato.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Turquoise",{get:function(){return a._namedColors.turquoise.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Violet",{get:function(){return a._namedColors.violet.Clone()},enumerable:!0,configurable:!0});
Object.defineProperty(a,"Wheat",{get:function(){return a._namedColors.wheat.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"White",{get:function(){return a._namedColors.white.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"WhiteSmoke",{get:function(){return a._namedColors.whitesmoke.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,"Yellow",{get:function(){return a._namedColors.yellow.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(a,
"YellowGreen",{get:function(){return a._namedColors.yellowgreen.Clone()},enumerable:!0,configurable:!0});a.prototype.Clone=function(){return new a(this.R,this.G,this.B,this.A)};a.prototype.Dispose=function(){this._onChange.Dispose()};a.prototype.toString=function(){void 0===this._cached&&(this._cached="rgba("+this.R+","+this.G+","+this.B+","+this.A+")");return this._cached};a.RgbaHexRegExp=/^([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i;a.RgbRegExp=/^(argb|rgb|rgba)\s*\(\s*([\d+(\.\d+)]{0,3})\s*,\s*([\d]{0,3})\s*,\s*([\d]{0,3})\s*(?:,\s*([\d+(\.\d+)]{0,3})\s*)?\s*\)$/i;
a.RgbaRegExp=/^([a-f\d])([a-f\d])([a-f\d])$/i;a._namedColors={transparent:new a(255,255,255,0),aliceblue:new a("#f0f8ff"),antiquewhite:new a("#faebd7"),aqua:new a("#00ffff"),aquamarine:new a("#7fffd4"),azure:new a("#f0ffff"),beige:new a("#f5f5dc"),bisque:new a("#ffe4c4"),black:new a("#000000"),blanchedalmond:new a("#ffebcd"),blue:new a("#0000ff"),blueviolet:new a("#8a2be2"),brown:new a("#a52a2a"),burlywood:new a("#deb887"),cadetblue:new a("#5f9ea0"),chartreuse:new a("#7fff00"),chocolate:new a("#d2691e"),
coral:new a("#ff7f50"),cornflowerblue:new a("#6495ed"),cornsilk:new a("#fff8dc"),crimson:new a("#dc143c"),cyan:new a("#00ffff"),darkblue:new a("#00008b"),darkcyan:new a("#008b8b"),darkgoldenrod:new a("#b8860b"),darkgray:new a("#a9a9a9"),darkgreen:new a("#006400"),darkkhaki:new a("#bdb76b"),darkmagenta:new a("#8b008b"),darkolivegreen:new a("#556b2f"),darkorange:new a("#ff8c00"),darkorchid:new a("#9932cc"),darkred:new a("#8b0000"),darksalmon:new a("#e9967a"),darkseagreen:new a("#8fbc8f"),darkslateblue:new a("#483d8b"),
darkslategray:new a("#2f4f4f"),darkturquoise:new a("#00ced1"),darkviolet:new a("#9400d3"),deeppink:new a("#ff1493"),deepskyblue:new a("#00bfff"),dimgray:new a("#696969"),dodgerblue:new a("#1e90ff"),firebrick:new a("#b22222"),floralwhite:new a("#fffaf0"),forestgreen:new a("#228b22"),fuchsia:new a("#ff00ff"),gainsboro:new a("#dcdcdc"),ghostwhite:new a("#f8f8ff"),gold:new a("#ffd700"),goldenrod:new a("#daa520"),gray:new a("#808080"),green:new a("#008000"),greenyellow:new a("#adff2f"),honeydew:new a("#f0fff0"),
hotpink:new a("#ff69b4"),indianred:new a("#cd5c5c"),indigo:new a("#4b0082"),ivory:new a("#fffff0"),khaki:new a("#f0e68c"),lavender:new a("#e6e6fa"),lavenderblush:new a("#fff0f5"),lawngreen:new a("#7cfc00"),lemonchiffon:new a("#fffacd"),lightblue:new a("#add8e6"),lightcoral:new a("#f08080"),lightcyan:new a("#e0ffff"),lightgoldenrodyellow:new a("#fafad2"),lightgray:new a("#d3d3d3"),lightgrey:new a("#d3d3d3"),lightgreen:new a("#90ee90"),lightpink:new a("#ffb6c1"),lightsalmon:new a("#ffa07a"),lightseagreen:new a("#20b2aa"),
lightskyblue:new a("#87cefa"),lightslategray:new a("#778899"),lightsteelblue:new a("#b0c4de"),lightyellow:new a("#ffffe0"),lime:new a("#00ff00"),limegreen:new a("#32cd32"),linen:new a("#faf0e6"),magenta:new a("#ff00ff"),maroon:new a("#800000"),mediumaquamarine:new a("#66cdaa"),mediumblue:new a("#0000cd"),mediumorchid:new a("#ba55d3"),mediumpurple:new a("#9370d8"),mediumseagreen:new a("#3cb371"),mediumslateblue:new a("#7b68ee"),mediumspringgreen:new a("#00fa9a"),mediumturquoise:new a("#48d1cc"),mediumvioletred:new a("#c71585"),
midnightblue:new a("#191970"),mintcream:new a("#f5fffa"),mistyrose:new a("#ffe4e1"),moccasin:new a("#ffe4b5"),navajowhite:new a("#ffdead"),navy:new a("#000080"),oldlace:new a("#fdf5e6"),olive:new a("#808000"),olivedrab:new a("#6b8e23"),orange:new a("#ffa500"),orangered:new a("#ff4500"),orchid:new a("#da70d6"),palegoldenrod:new a("#eee8aa"),palegreen:new a("#98fb98"),paleturquoise:new a("#afeeee"),palevioletred:new a("#d87093"),papayawhip:new a("#ffefd5"),peachpuff:new a("#ffdab9"),peru:new a("#cd853f"),
pink:new a("#ffc0cb"),plum:new a("#dda0dd"),powderblue:new a("#b0e0e6"),purple:new a("#800080"),red:new a("#ff0000"),rosybrown:new a("#bc8f8f"),royalblue:new a("#4169e1"),saddlebrown:new a("#8b4513"),salmon:new a("#fa8072"),sandybrown:new a("#f4a460"),seagreen:new a("#2e8b57"),seashell:new a("#fff5ee"),sienna:new a("#a0522d"),silver:new a("#c0c0c0"),skyblue:new a("#87ceeb"),slateblue:new a("#6a5acd"),slategray:new a("#708090"),snow:new a("#fffafa"),springgreen:new a("#00ff7f"),steelblue:new a("#4682b4"),
tan:new a("#d2b48c"),teal:new a("#008080"),thistle:new a("#d8bfd8"),tomato:new a("#ff6347"),turquoise:new a("#40e0d0"),violet:new a("#ee82ee"),wheat:new a("#f5deb3"),white:new a("#ffffff"),whitesmoke:new a("#f5f5f5"),yellow:new a("#ffff00"),yellowgreen:new a("#9acd32")};return a}();f.Color=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,g){c=c.Milliseconds;return(b-a)*(c/=g.Milliseconds)*c*(2.70158*c-1.70158)+a};a._easeOut=function(a,b,
c,g){c=c.Milliseconds;return(b-a)*((c=c/g.Milliseconds-1)*c*(2.70158*c+1.70158)+1)+a};a._easeInOut=function(a,b,c,g){b-=a;c=c.Milliseconds;var d=1.70158;return 1>(c/=g.Milliseconds/2)?b/2*c*c*(((d*=1.525)+1)*c-d)+a:b/2*((c-=2)*c*(((d*=1.525)+1)*c+d)+2)+a};return a}();b.Back=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));(function(b){b=b.MapLoaders||(b.MapLoaders={});b=b.JSONFormat||(b.JSONFormat={});b[b.TMX=0]="TMX"})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c,h,g,d){"undefined"===typeof g&&(g=h.ClipSize.Width);"undefined"===typeof d&&(d=h.ClipSize.Height);a.call(this,new b.Vector2d(e,c));this._type="Sprite2d";this.Image=h;this.Size=new b.Size2d(g,d)}__extends(c,a);c.prototype.Draw=function(b){a.prototype._StartDraw.call(this,b);b.drawImage(this.Image.Source,this.Image.ClipLocation.X,this.Image.ClipLocation.Y,this.Image.ClipSize.Width,this.Image.ClipSize.Height,-this.Size.HalfWidth,-this.Size.HalfHeight,
this.Size.Width,this.Size.Height);a.prototype._EndDraw.call(this,b)};c.prototype.GetDrawBounds=function(){var a=new b.Bounds.BoundingRectangle(this.Position,this.Size);a.Rotation=this.Rotation;return a};c.prototype.Scale=function(a){this.Size.Width*=a;this.Size.Height*=a};c.prototype.Clone=function(){var b=new c(this.Position.X,this.Position.Y,this.Image.Clone(),this.Size.Width,this.Size.Height);a.prototype._Clone.call(this,b);return b};return c}(b.Graphics.Graphic2d);f.Sprite2d=d})(b.Graphics||(b.Graphics=
{}))})(EndGate||(EndGate={}));(function(b){(function(f){var d=function(a){function c(e,c,h){a.call(this,new b.Vector2d(e,c));this._Resources=h}__extends(c,a);c.prototype.Scale=function(a){throw Error("Scale is not implemented for TileMaps.");};return c}(b.Graphics.Graphic2d);f.TileMap=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c,h,g,d,f){"undefined"===typeof d&&(d=1);var k=this;a.call(this,b.Vector2d.Zero);this._type="Line2d";this._from=new b.Vector2d(e,c);this._to=new b.Vector2d(h,g);this.LineWidth=d;this.UpdatePosition();this._strokeChangeWire=function(a){k._State.StrokeStyle=a.toString()};"undefined"!==typeof f?("string"===typeof f&&(f=new b.Graphics.Color(f)),this.Color=this._strokeStyle=f):this.Color=this._strokeStyle=b.Graphics.Color.Black}__extends(c,a);Object.defineProperty(c.prototype,
"From",{get:function(){return this._from},set:function(a){this._from=a;this.UpdatePosition()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"To",{get:function(){return this._to},set:function(a){this._to=a;this.UpdatePosition()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Color",{get:function(){return this._strokeStyle},set:function(a){"string"===typeof a&&(a=new b.Graphics.Color(a));this._strokeStyle.OnChange.Unbind(this._strokeChangeWire);this._strokeStyle=
a;this._strokeStyle.OnChange.Bind(this._strokeChangeWire);this._strokeChangeWire(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"LineWidth",{get:function(){return this._State.LineWidth},set:function(a){this._State.LineWidth=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"LineCap",{get:function(){return this._State.LineCap},set:function(a){this._State.LineCap=a},enumerable:!0,configurable:!0});c.prototype.Draw=function(b){this._strokeStyle.toString()!==
this._State.StrokeStyle&&(this._State.StrokeStyle=this._strokeStyle.toString());a.prototype._StartDraw.call(this,b);this._cachedPosition.Equivalent(this.Position)||this.RefreshCache();b.beginPath();b.moveTo(this._from.X-this.Position.X,this._from.Y-this.Position.Y);b.lineTo(this._to.X-this.Position.X,this._to.Y-this.Position.Y);b.stroke();a.prototype._EndDraw.call(this,b)};c.prototype.GetDrawBounds=function(){var a=new b.Bounds.BoundingRectangle(this.Position,new b.Size2d(this._boundsWidth,this.LineWidth));
a.Rotation=Math.atan2(this._difference.Y,this._difference.X)+this.Rotation;return a};c.prototype.Scale=function(a){this.From=this.Position.Add(this.From.Subtract(this.Position).Multiply(a));this.To=this.Position.Add(this.To.Subtract(this.Position).Multiply(a))};c.prototype.Clone=function(){var b=new c(this.From.X,this.From.Y,this.To.X,this.To.Y,this.LineWidth,this.Color.Clone());b.LineCap=this.LineCap;a.prototype._Clone.call(this,b);return b};c.prototype.Dispose=function(){a.prototype.Dispose.call(this);
this._strokeStyle.OnChange.Unbind(this._strokeChangeWire)};c.prototype.UpdatePosition=function(){this.Position=this._from.Add(this._to).Divide(2);this._difference=this._to.Subtract(this._from);this._boundsWidth=this._from.Distance(this._to).Length();this._cachedPosition=this.Position.Clone()};c.prototype.RefreshCache=function(){var a=this.Position.Subtract(this._cachedPosition);this._from.X+=a.X;this._from.Y+=a.Y;this._to.X+=a.X;this._to.Y+=a.Y;this._cachedPosition=this.Position.Clone()};return c}(b.Graphics.Graphic2d);
f.Line2d=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(e,c,h,g,d,f,k,l){"undefined"===typeof k&&(k=!1);"undefined"===typeof l&&(l=new b.Graphics.Color("gray"));a.call(this,new b.Vector2d(e,c));this._type="Grid";this._size=new b.Size2d(d*g,f*h);this._tileSize=new b.Size2d(d,f);this._grid=[];this._rows=h;this._columns=g;this._gridLines=[];this.GridLineColor=l;this.DrawGridLines=k;for(e=0;e<this._rows;e++)for(this._grid[e]=[],c=0;c<this._columns;c++)this._grid[e].push(null)}__extends(c,a);Object.defineProperty(c.prototype,
"DrawGridLines",{get:function(){return this._drawGridLines},set:function(a){a&&0===this._gridLines.length&&this.BuildGridLines();this._drawGridLines=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"GridLineColor",{get:function(){return this._gridLineColor},set:function(a){"string"===typeof a&&(a=new b.Graphics.Color(a));this._gridLineColor=a;for(var c=0;c<this._gridLines.length;c++)this._gridLines[c].Color=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Size",
{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"TileSize",{get:function(){return this._tileSize.Clone()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0});c.prototype.Fill=function(a,b,c){c&&(this.ValidRow(a)&&this.ValidColumn(b))&&(c.Position=
this.GetInsideGridPosition(a,b),this._grid[a][b]=c,this.AddChild(c))};c.prototype.FillRow=function(a,b,c){"undefined"===typeof c&&(c=0);for(var g,d=0;d<b.length;d++)g=b[d],g.Position=this.GetInsideGridPosition(a,d+c),this._grid[a][d+c]=g,this.AddChild(g)};c.prototype.FillColumn=function(a,b,c){"undefined"===typeof c&&(c=0);for(var g,d=0;d<b.length;d++)g=b[d],g.Position=this.GetInsideGridPosition(d+c,a),this._grid[d+c][a]=g,this.AddChild(g)};c.prototype.FillSpace=function(a,b,c){for(var g,d=0;d<c.length;d++)for(var f=
0;f<c[d].length;f++)if(g=c[d][f])g.Position=this.GetInsideGridPosition(d+a,f+b),this._grid[d+a][f+b]=g,this.AddChild(g)};c.prototype.Get=function(a,b){return this.ValidRow(a)&&this.ValidColumn(b)?this._grid[a][b]:null};c.prototype.GetRow=function(a,b){"undefined"===typeof b&&(b=0);for(var c=[],g=b;g<this._columns;g++)c.push(this._grid[a][g]);return c};c.prototype.GetColumn=function(a,b){"undefined"===typeof b&&(b=0);for(var c=[],g=b;g<this._rows;g++)c.push(this._grid[g][a]);return c};c.prototype.GetSpace=
function(a,b,c,g){for(var d=[],f=c>=a?1:-1,k=g>=b?1:-1;a!==c+f&&!(a>=this._rows);a+=f)for(var l=b;l!==g+k&&!(l>=this._columns);l+=k)d.push(this._grid[a][l]);return d};c.prototype.Clear=function(a,b){if(!this.ValidRow(a)||!this.ValidColumn(b))return null;var c=this._grid[a][b];this._grid[a][b]=null;this.RemoveChild(c);return c};c.prototype.ClearRow=function(a,b){for(var c=[],g=0;g<this._columns;g++)c.push(this._grid[a][g]),this.RemoveChild(this._grid[a][g]),this._grid[a][g]=null;return c};c.prototype.ClearColumn=
function(a,b){for(var c=[],g=0;g<this._rows;g++)c.push(this._grid[g][a]),this.RemoveChild(this._grid[g][a]),this._grid[g][a]=null;return c};c.prototype.ClearSpace=function(a,b,c,g){for(var d=[],f=c>=a?1:-1,k=g>=b?1:-1;a!==c+f&&!(a>this._rows);a+=f)for(var l=b;l!==g+k&&!(l>this._columns);l+=k)d.push(this._grid[a][l]),this.RemoveChild(this._grid[a][l]),this._grid[a][l]=null;return d};c.prototype.Draw=function(b){a.prototype._StartDraw.call(this,b);b.save();a.prototype._EndDraw.call(this,b);if(this.DrawGridLines)for(var c=
0;c<this._gridLines.length;c++)this._gridLines[c].Draw(b);b.restore()};c.prototype.GetDrawBounds=function(){var a=new b.Bounds.BoundingRectangle(this.Position,this._size);a.Rotation=this.Rotation;return a};c.prototype.Scale=function(a){throw Error("Scale is not implemented for the Grid class.");};c.prototype.ConvertToRow=function(a){return Math.floor((a-(this.Position.Y-this._size.HalfHeight))/this._tileSize.Height)};c.prototype.ConvertToColumn=function(a){return Math.floor((a-(this.Position.X-this._size.HalfWidth))/
this._tileSize.Width)};c.prototype.Clone=function(){for(var a=new c(this.Position.X,this.Position.Y,this._rows,this._columns,this._tileSize.Width,this._tileSize.Height,this._drawGridLines,this._gridLineColor.Clone()),b=0;b<this._grid.length;b++)for(var h=0;h<this._grid[b].length;h++)this._grid[b][h]&&a.Fill(b,h,this._grid[b][h].Clone());a.Opacity=this.Opacity;a.Rotation=this.Rotation;a.Visible=this.Visible;a.ZIndex=this.ZIndex;return a};c.prototype.BuildGridLines=function(){for(var a=this._size.Multiply(0.5),
c=new b.Vector2d(-a.Width,-a.Height),a=new b.Vector2d(a.Width,a.Height),h=0;h<this._rows;h++)if(this._gridLines.push(new b.Graphics.Line2d(c.X,c.Y+h*this._tileSize.Height,a.X,c.Y+h*this._tileSize.Height,1,this._gridLineColor)),0===h)for(var d=0;d<this._columns;d++)this._gridLines.push(new b.Graphics.Line2d(c.X+d*this._tileSize.Width,c.Y,c.X+d*this._tileSize.Width,a.Y,1,this._gridLineColor));this._gridLines.push(new b.Graphics.Line2d(c.X,a.Y,a.X,a.Y,1));this._gridLines.push(new b.Graphics.Line2d(a.X,
c.Y,a.X,a.Y,1))};c.prototype.GetInsideGridPosition=function(a,c){return new b.Vector2d(c*this._tileSize.Width-this._size.HalfWidth+this._tileSize.HalfWidth,a*this._tileSize.Height-this._size.HalfHeight+this._tileSize.HalfHeight)};c.prototype.ValidRow=function(a){return 0<=a&&a<this._rows};c.prototype.ValidColumn=function(a){return 0<=a&&a<this._columns};return c}(b.Graphics.Graphic2d);f.Grid=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){var a=function(a){function b(e,h,d){a.call(this,0,0,e,h,d)}__extends(b,a);return b}(b.Graphics.Sprite2d);d.SquareTile=a})(f.Assets||(f.Assets={}))})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,n,h,d,f,p,k,l){"undefined"===typeof k&&(k=!0);"undefined"===typeof l&&(l=!1);var m=this;a.call(this,c,n,f);this._mappings=p;this._grid=new b.Graphics.Grid(0,0,p.length,p[0].length,h,d,l);this._staticMap=k;this._onTileLoad=new b.EventHandler2;this._onLoaded=new b.EventHandler;this._loaded=!1;this._tilesBuilt=0;this._totalTiles=this._grid.Rows*this._grid.Columns;this.RowLoadDelay=this.TileLoadDelay=b.TimeSpan.Zero;this._staticMap&&this.BuildCache();
setTimeout(function(){m.FillGridWith(p,function(){m._loaded=!0;m._onLoaded.Trigger()})},0)}__extends(c,a);Object.defineProperty(c.prototype,"OnTileLoad",{get:function(){return this._onTileLoad},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0});c.ExtractTiles=function(a,b,c){for(var d=[],f=Math.floor(a.ClipSize.Width/b),p=Math.floor(a.ClipSize.Height/c),k=0;k<p;k++)for(var l=0;l<f;l++)d.push(a.Extract(l*
b,k*c,b,c));return d};c.prototype.IsLoaded=function(){return this._loaded};c.prototype.Draw=function(b){a.prototype._StartDraw.call(this,b);this._staticMap?b.drawImage(this._mapCache,-this._mapCache.width/2,-this._mapCache.height/2):this._grid.Draw(b);a.prototype._EndDraw.call(this,b)};c.prototype.GetDrawBounds=function(){var a=this._grid.GetDrawBounds();a.Position=this.Position;return a};c.prototype.Dispose=function(){this._grid.Dispose();this._onLoaded.Dispose();this._onTileLoad.Dispose();a.prototype.Dispose.call(this)};
c.prototype.Clone=function(){var a=new c(this.Position.X,this.Position.Y,this._grid.TileSize.Width,this._grid.TileSize.Height,this._Resources,this._mappings);a.Opacity=this.Opacity;a.Rotation=this.Rotation;a.Visible=this.Visible;a.ZIndex=this.ZIndex;a.RowLoadDelay=this.RowLoadDelay.Clone();a.TileLoadDelay=this.TileLoadDelay.Clone();return a};c.prototype.BuildCache=function(){var a=this._grid.Size;this._mapCache=document.createElement("canvas");this._mapCache.width=a.Width;this._mapCache.height=a.Height;
this._mapCacheContext=this._mapCache.getContext("2d");this._mapCacheContext.translate(a.HalfWidth,a.HalfHeight)};c.prototype.CacheTile=function(a){a.Draw(this._mapCacheContext)};c.prototype.FillGridWith=function(a,b){var c=this;asyncLoop(function(b,d){c.AsyncBuildGridRow(d,a,function(){b()})},a.length,function(){b()})};c.prototype.AsyncBuildGridTile=function(a,c,h,d){var f=this,p=function(){var k;k=new b.Graphics.Assets.SquareTile(f._Resources[h],f._grid.TileSize.Width,f._grid.TileSize.Height);f._grid.Fill(a,
c,k);f.OnTileLoad.Trigger({Tile:k,Row:a,Column:c,ResourceIndex:h,Parent:f},f._tilesBuilt/f._totalTiles);f._staticMap&&f.CacheTile(k);d(k)};0<this.TileLoadDelay.Milliseconds?setTimeout(p,this.TileLoadDelay.Milliseconds):p()};c.prototype.AsyncBuildGridRow=function(a,b,c){var d=this;setTimeout(function(){asyncLoop(function(c,h){d._tilesBuilt++;0<=b[a][h]?d.AsyncBuildGridTile(a,h,b[a][h],function(a){c()}):c()},b[a].length,function(){c()})},this.RowLoadDelay.Milliseconds)};return c}(b.Graphics.TileMap);
f.SquareTileMap=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){(function(a){var c=function(){function a(){}a.prototype.Load=function(c,h,d){var f=this,p=0,k=0,l=new b.EventHandler1;this.LoadTilesetSources(c.tilesets,function(b){p+=1/c.tilesets.length*a._imagePercentMax;l.Trigger(p)},function(b){var k=f.ExtractTilesetTiles(c.tilesets,b,h),m=[],t=(1-a._imagePercentMax)/c.layers.length;p=a._imagePercentMax;asyncLoop(function(a,b){if("tilelayer"!==c.layers[b].type)throw Error("Invalid layer type.  The layer type '"+c.layers[b].type+
"' is not supported.");f.AsyncBuildLayer(c,b,h,k,function(a,b){l.Trigger(p+b*t)},function(b){p+=t;l.Trigger(p);m.push(b);a()})},c.layers.length,function(){d({Layers:m})})});for(var m=0;m<c.layers.length;m++)k+=c.layers[m].data.length;return{TileCount:k,LayerCount:c.layers.length,ResourceSheetCount:c.tilesets.length,OnPercentLoaded:l}};a.prototype.LoadTilesetSources=function(a,c,e){for(var d={},f=0,k=function(b){c(b);++f===a.length&&e(d)},l=0;l<a.length;l++)d[a[l].name]=new b.Graphics.ImageSource(a[l].image,
a[l].imagewidth,a[l].imageheight),d[a[l].name].OnLoaded.Bind(k)};a.prototype.ExtractTilesetTiles=function(a,c,e){var d=[],f=[],k,l;a.sort(function(a,b){return a.firstgid-b.firstgid});for(var m=0;m<a.length;m++){k=b.Graphics.SquareTileMap.ExtractTiles(c[a[m].name],a[m].tilewidth,a[m].tileheight);for(var r in a[m].properties)if("undefined"!==typeof e.ResourceSheetHooks[r])for(l=a[m].firstgid-1;l<a[m].firstgid-1+k.length;l++)"undefined"===typeof f[l]&&(f[l]=[]),f[l].push(this.BuildHookerFunction(a[m].properties[r],
e.ResourceSheetHooks[r]));for(var s in a[m].tileproperties)for(r in a[m].tileproperties[s])"undefined"!==typeof e.ResourceTileHooks[r]&&(l=parseInt(s)+a[m].firstgid-1,"undefined"===typeof f[l]&&(f[l]=[]),f[l].push(this.BuildHookerFunction(a[m].tileproperties[s][r],e.ResourceTileHooks[r])));d=d.concat(k)}return{Resources:d,ResourceHooks:f}};a.prototype.AsyncBuildLayer=function(a,c,e,d,f,k){var l=this;setTimeout(function(){var m=a.layers[c],r=l.NormalizeLayerData(m.data,a.width),s=new b.Graphics.SquareTileMap(m.x,
m.y,a.tilewidth,a.tileheight,d.Resources,r),u=[],t;for(t in m.properties)"undefined"!==typeof e.LayerHooks[t]&&u.push(l.BuildHookerFunction(m.properties[t],e.LayerHooks[t]));s.ZIndex=c;s.Visible=m.visible;s.Opacity=m.opacity;s.RowLoadDelay=b.TimeSpan.FromMilliseconds(5);s.OnTileLoad.Bind(function(a,b){if(d.ResourceHooks[a.ResourceIndex])for(var c=0;c<d.ResourceHooks[a.ResourceIndex].length;c++)d.ResourceHooks[a.ResourceIndex][c](a);for(c=0;c<u.length;c++)u[c](a);f(a,b)});s.OnLoaded.Bind(function(){k(s)})},
0)};a.prototype.BuildHookerFunction=function(a,b){return function(c){return b(c,a)}};a.prototype.NormalizeLayerData=function(a,b){for(var c=[],e,d=0;d<a.length;d++)e=Math.floor(d/b),c[e]instanceof Array||(c[e]=[]),c[e].push(a[d]-1);return c};a._imagePercentMax=0.2;return a}();a.OrthogonalLoader=c})(d.TMX||(d.TMX={}))})(f._||(f._={}))})(b.MapLoaders||(b.MapLoaders={}))})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){(function(a){var c=function(){function a(){this._orientationLoaders={orthogonal:new b.MapLoaders._.TMX.OrthogonalLoader}}a.prototype.Load=function(a,b,c){if(!this._orientationLoaders[a.orientation])throw Error("Invalid orientation.  The orientation '"+a.orientation+"' is not supported.");return this._orientationLoaders[a.orientation].Load(a,b,c)};return a}();a.TMXLoader=c})(d.TMX||(d.TMX={}))})(f._||(f._={}))})(b.MapLoaders||(b.MapLoaders={}))})(EndGate||(EndGate=
{}));(function(b){(function(f){var d=function(){function a(){}a.Load=function(c,e,d,h){"undefined"===typeof h&&(h=0);d||(d={ResourceTileHooks:{},ResourceSheetHooks:{},LayerHooks:{}});return a._loaders[b.MapLoaders.JSONFormat[h]].Load(c,d,e)};a._loaders={TMX:new b.MapLoaders._.TMX.TMXLoader};return a}();f.JSONLoader=d})(b.MapLoaders||(b.MapLoaders={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,b){"undefined"===typeof b&&(b=a);this.Min=a;this.Max=b}a.prototype.Clone=function(){return new a(this.Min,this.Max)};a.RandomNumber=function(a){return Math.random()*(a.Max-a.Min)+a.Min};a.RandomTimeSpan=function(a){return b.TimeSpan.FromMilliseconds(Math.floor(Math.random()*(a.Max.Milliseconds-a.Min.Milliseconds+1)+a.Min.Milliseconds))};return a}();f.Range=d})(b.Particles||(b.Particles={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(b,c,h,d){a.call(this,b,c,h,d)}__extends(c,a);c.prototype._UpdateTween=function(){this.Current=new b.Vector2d(this.TweeningFunction(this.From.X,this.To.X,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Y,this.To.Y,this.Elapsed,this.Duration))};return c}(b.Tweening.Tween);f.Vector2dTween=d})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function b(c,d,h,g){a.call(this,c,d,h,g)}__extends(b,a);b.prototype._UpdateTween=function(){this.Current=this.TweeningFunction(this.From,this.To,this.Elapsed,this.Duration)};return b}(b.Tweening.Tween);f.NumberTween=d})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,e,d,h,g,f,p,k,l,m,r){a.Position=e;a.Scale(h);a.Rotation=f;a.Opacity=0;this._texture=a;this._rotationSpeed=p;this._alive=!0;this._fadingOut=!1;this._lifetime=k;this._createdAt=(new Date).getTime();this._onDeath=new b.EventHandler1;this._fadeOutDuration=m;this._fadeOutAt=k.Milliseconds-m.Milliseconds;this._locationTween=new b.Tweening.Vector2dTween(a.Position,d,k,r);this._fadeTween=new b.Tweening.NumberTween(0,100*g,l,b.Tweening.Functions.Linear.EaseNone);
this._locationTween.Play();this._fadeTween.Play()}Object.defineProperty(a.prototype,"Texture",{get:function(){return this._texture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"OnDeath",{get:function(){return this._onDeath},enumerable:!0,configurable:!0});a.prototype.IsAlive=function(){return this._alive};a.prototype.Update=function(a){var b;this._alive&&(b=a.Now.getTime()-this._createdAt,b>this._lifetime.Milliseconds?(this._alive=!1,this._onDeath.Trigger(this)):(!this._fadingOut&&
b>=this._fadeOutAt&&(this._fadingOut=!0,this._fadeTween.From=100*this._texture.Opacity,this._fadeTween.To=0,this._fadeTween.Duration=this._fadeOutDuration,this._fadeTween.Restart()),this._locationTween.Update(a),this._fadeTween.Update(a),this._texture.Rotation+=a.Elapsed.Seconds*this._rotationSpeed,this._texture.Position=this._locationTween.Current,this._texture.Opacity=this._fadeTween.Current/100))};return a}();f.Particle=d})(b.Particles||(b.Particles={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d,h){var g=this;a.call(this,new b.Vector2d(c,d));this.EmissionInterval=new b.Particles.Range(b.TimeSpan.FromMilliseconds(30));this.EmissionDirection=new b.Particles.Range(0,2*Math.PI);this.EmissionOutput=new b.Particles.Range(1);this.ParticleLifetime=new b.Particles.Range(b.TimeSpan.FromSeconds(1),b.TimeSpan.FromSeconds(3));this.ParticleSpeed=new b.Particles.Range(30,100);this.ParticleScale=new b.Particles.Range(0.75,1.5);this.ParticleRotation=
new b.Particles.Range(0,2*Math.PI);this.ParticleRotationSpeed=new b.Particles.Range(0,Math.PI);this.ParticleOpacity=new b.Particles.Range(1);this.ParticleFadeInDuration=new b.Particles.Range(b.TimeSpan.FromSeconds(0.5));this.ParticleFadeOutDuration=new b.Particles.Range(b.TimeSpan.FromSeconds(0.5),b.TimeSpan.FromSeconds(1));this._texturePool=[];this._particlePool={};this._particleId=0;this._emitting=!1;this._particleRemover=function(a){g.RemoveChild(a.Texture);delete g._particlePool[a._id]};this.EmissionFunction=
h}__extends(c,a);c.prototype.IsEmitting=function(){return this._emitting};c.prototype.Start=function(){if(0===this._texturePool.length)throw Error("Cannot start Emitter without any textures added to it.");this._emitting=!0;this._lastEmit=(new Date).getTime()};c.prototype.Stop=function(){this._emitting=!1};c.prototype.AddTexture=function(a,b){"undefined"===typeof b&&(b=1);for(var c=0;c<b;c++)this._texturePool.push(a)};c.prototype.RemoveTexture=function(a){for(var b=0;b<this._texturePool.length;b++)this._texturePool[b]===
a&&this._texturePool.splice(b--,1)};c.prototype.Emit=function(){for(var a=b.Particles.Range.RandomNumber(this.EmissionOutput),c,h,d,f=[],p=0;p<a;p++)d=b.Particles.Range.RandomTimeSpan(this.ParticleLifetime),h=b.Particles.Range.RandomNumber(this.ParticleSpeed),c=b.Particles.Range.RandomNumber(this.EmissionDirection),c=(new b.Vector2d(d.Seconds*h,0)).RotateAround(b.Vector2d.Zero,c),d=new b.Particles.Particle(this.BuildTextureFromPool(),b.Vector2d.Zero,c,b.Particles.Range.RandomNumber(this.ParticleScale),
b.Particles.Range.RandomNumber(this.ParticleOpacity),b.Particles.Range.RandomNumber(this.ParticleRotation),b.Particles.Range.RandomNumber(this.ParticleRotationSpeed),d,b.Particles.Range.RandomTimeSpan(this.ParticleFadeInDuration),b.Particles.Range.RandomTimeSpan(this.ParticleFadeOutDuration),this.EmissionFunction),d._id=this._particleId++,this._particlePool[d._id]=d,this.AddChild(d.Texture),d.OnDeath.Bind(this._particleRemover),f.push(d);return f};c.prototype.Draw=function(b){a.prototype._StartDraw.call(this,
b);a.prototype._EndDraw.call(this,b)};c.prototype.Scale=function(a){throw Error("Scale is not implemented for the Emitter class.");};c.prototype.Update=function(a){var c,h;if(this._emitting){h=b.Particles.Range.RandomTimeSpan(this.EmissionInterval).Milliseconds;if(0<h&&(c=a.Now.getTime()-this._lastEmit,c=Math.floor(c/h),0<c))for(this._lastEmit=a.Now.getTime(),h=0;h<c;h++)this.Emit();for(var d in this._particlePool)this._particlePool[d].Update(a)}};c.prototype.GetDrawBounds=function(){return new b.Bounds.BoundingCircle(this.Position,
this.ParticleSpeed.Max*this.ParticleLifetime.Max.Seconds)};c.prototype.Clone=function(){for(var a=new c(this.Position.X,this.Position.Y,this.EmissionFunction),b=0;b<this._texturePool.length;b++)a.AddTexture(this._texturePool[b]);a.EmissionInterval=this.EmissionInterval.Clone();a.EmissionDirection=this.EmissionDirection.Clone();a.EmissionOutput=this.EmissionOutput.Clone();a.ParticleLifetime=this.ParticleLifetime.Clone();a.ParticleSpeed=this.ParticleSpeed.Clone();a.ParticleRotation=this.ParticleRotation.Clone();
a.ParticleRotationSpeed=this.ParticleRotationSpeed.Clone();a.ParticleFadeInDuration=this.ParticleFadeInDuration.Clone();a.ParticleFadeOutDuration=this.ParticleFadeOutDuration.Clone();a.ParticleScale=this.ParticleScale.Clone();a.ParticleOpacity=this.ParticleOpacity.Clone();a.Opacity=this.Opacity;a.Rotation=this.Rotation;a.Visible=this.Visible;a.ZIndex=this.ZIndex;return a};c.prototype.BuildTextureFromPool=function(){var a=Math.floor(Math.random()*this._texturePool.length);return this._texturePool[a].Clone()};
return c}(b.Graphics.Graphic2d);f.Emitter=d})(b.Particles||(b.Particles={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function b(c,d,h,f){a.call(this,c,d,h,f)}__extends(b,a);b.prototype._UpdateTween=function(){this.Current.R=this.TweeningFunction(this.From.R,this.To.R,this.Elapsed,this.Duration);this.Current.G=this.TweeningFunction(this.From.G,this.To.G,this.Elapsed,this.Duration);this.Current.B=this.TweeningFunction(this.From.B,this.To.B,this.Elapsed,this.Duration)};return b}(b.Tweening.Tween);f.ColorTween=d})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return(b-a)*(c/=d.Milliseconds)*c*c+a};a._easeOut=function(a,b,c,d){c=c.Milliseconds;
return(b-a)*((c=c/d.Milliseconds-1)*c*c+1)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 1>(c/=d.Milliseconds/2)?b/2*c*c*c+a:b/2*((c-=2)*c*c+2)+a};return a}();b.Cubic=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return-(b-a)*(Math.sqrt(1-(c/=d.Milliseconds)*c)-1)+a};a._easeOut=function(a,b,c,
d){c=c.Milliseconds;return(b-a)*Math.sqrt(1-(c=c/d.Milliseconds-1)*c)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 1>(c/=d.Milliseconds/2)?-b/2*(Math.sqrt(1-c*c)-1)+a:b/2*(Math.sqrt(1-(c-=2)*c)+1)+a};return a}();b.Circular=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(b,d,h,f){d-=b;return d-a.EaseOut(0,d,f.Subtract(h),f)+b};a._easeOut=function(a,b,c,d){b-=a;c=c.Milliseconds;
return(c/=d.Milliseconds)<1/2.75?b*7.5625*c*c+a:c<2/2.75?b*(7.5625*(c-=1.5/2.75)*c+0.75)+a:c<2.5/2.75?b*(7.5625*(c-=2.25/2.75)*c+0.9375)+a:b*(7.5625*(c-=2.625/2.75)*c+0.984375)+a};a._easeInOut=function(b,d,h,f){d-=b;return h.Milliseconds<f.Milliseconds/2?0.5*a.EaseIn(0,d,h.Multiply(2),f)+b:0.5*a.EaseOut(0,d,h.Multiply(2).Subtract(f),f)+0.5*d+b};return a}();b.Bounce=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return 0==c?a:(b-a)*Math.pow(2,10*(c/d.Milliseconds-1))+a};a._easeOut=function(a,
b,c,d){b-=a;c=c.Milliseconds;return c==d.Milliseconds?a+b:b*(-Math.pow(2,-10*c/d.Milliseconds)+1)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 0==c?a:c==d.Milliseconds?a+b:1>(c/=d.Milliseconds/2)?b/2*Math.pow(2,10*(c-1))+a:b/2*(-Math.pow(2,-10*--c)+2)+a};return a}();b.Exponential=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){b-=a;c=c.Milliseconds;var f,p;if(0===c)return a;if(1===(c/=d.Milliseconds))return a+b;f=0.3*d.Milliseconds;
p=f/4;return-(b*Math.pow(2,10*(c-=1))*Math.sin((c*d.Milliseconds-p)*2*Math.PI/f))+a};a._easeOut=function(a,b,c,d){b-=a;c=c.Milliseconds;var f,p;if(0===c)return a;if(1===(c/=d.Milliseconds))return a+b;f=0.3*d.Milliseconds;p=f/4;return b*Math.pow(2,-10*c)*Math.sin((c*d.Milliseconds-p)*2*Math.PI/f)+b+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;var f,p;if(0===c)return a;if(2===(c/=d.Milliseconds/2))return a+b;f=d.Milliseconds*0.3*1.5;p=f/4;return 1>c?-0.5*b*Math.pow(2,10*(c-=1))*Math.sin((c*
d.Milliseconds-p)*2*Math.PI/f)+a:0.5*b*Math.pow(2,-10*(c-=1))*Math.sin((c*d.Milliseconds-p)*2*Math.PI/f)+b+a};return a}();b.Elastic=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return(b-a)*(c/=d.Milliseconds)*c+a};a._easeOut=function(a,b,c,d){c=c.Milliseconds;
return-(b-a)*(c/=d.Milliseconds)*(c-2)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 1>(c/=d.Milliseconds/2)?b/2*c*c+a:-b/2*(--c*(c-2)-1)+a};return a}();b.Quadratic=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return(b-a)*(c/=d.Milliseconds)*c*c*c+a};a._easeOut=function(a,b,c,d){c=c.Milliseconds;
return-(b-a)*((c=c/d.Milliseconds-1)*c*c*c-1)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 1>(c/=d.Milliseconds/2)?b/2*c*c*c*c+a:-b/2*((c-=2)*c*c*c-2)+a};return a}();b.Quartic=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){c=c.Milliseconds;return(b-a)*(c/=d.Milliseconds)*c*c*c*c+a};a._easeOut=function(a,b,c,d){c=c.Milliseconds;
return(b-a)*((c=c/d.Milliseconds-1)*c*c*c*c+1)+a};a._easeInOut=function(a,b,c,d){b-=a;c=c.Milliseconds;return 1>(c/=d.Milliseconds/2)?b/2*c*c*c*c*c+a:b/2*((c-=2)*c*c*c*c+2)+a};return a}();b.Quintic=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){function a(){}Object.defineProperty(a,"EaseIn",{get:function(){return a._easeIn},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseOut",{get:function(){return a._easeOut},enumerable:!0,configurable:!0});Object.defineProperty(a,"EaseInOut",{get:function(){return a._easeInOut},enumerable:!0,configurable:!0});a._easeIn=function(a,b,c,d){b-=a;return-b*Math.cos(c.Milliseconds/d.Milliseconds*(Math.PI/2))+b+a};a._easeOut=function(a,b,c,d){return(b-
a)*Math.sin(c.Milliseconds/d.Milliseconds*(Math.PI/2))+a};a._easeInOut=function(a,b,c,d){return-(b-a)/2*(Math.cos(Math.PI*c.Milliseconds/d.Milliseconds)-1)+a};return a}();b.Sinusoidal=a})(b.Functions||(b.Functions={}))})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(b,c,d,f){a.call(this,b,c,d,f)}__extends(c,a);c.prototype._UpdateTween=function(){this.Current=new b.Size2d(this.TweeningFunction(this.From.Width,this.To.Width,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Height,this.To.Height,this.Elapsed,this.Duration))};return c}(b.Tweening.Tween);f.Size2dTween=d})(b.Tweening||(b.Tweening={}))})(EndGate||(EndGate={}));
(function(b){(function(b){(function(b){var a=function(){return function(){this.Down=this.Up=this.Right=this.Left=!1}}();b.LinearDirections=a})(b.Assets||(b.Assets={}))})(b.MovementControllers||(b.MovementControllers={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a){this.Position=0<a.length?a[0].Position:b.Vector2d.Zero;this.Velocity=b.Vector2d.Zero;this.Rotation=0;this._frozen=!1;this._moveables=a}a.prototype.Freeze=function(){this._frozen=!0};a.prototype.Thaw=function(){this._frozen=!1};a.prototype.IsMoving=function(){return!this._frozen&&!this.Velocity.IsZero()};a.prototype.Update=function(a){for(a=0;a<this._moveables.length;a++)this._moveables[a].Position=this.Position,this._moveables[a].Rotation=this.Rotation};
return a}();f.MovementController=d})(b.MovementControllers||(b.MovementControllers={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d,f,g){"undefined"===typeof f&&(f=!0);"undefined"===typeof g&&(g=!0);var q=this;a.call(this,c);this._moveSpeed=d;this._moving=new b.MovementControllers.Assets.LinearDirections;this.OnMove=new b.EventHandler1;this._rotationUpdater=new b._.Utilities.NoopTripInvoker(function(){q.UpdateRotation()},f);this._velocityUpdater=g?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}__extends(c,a);c.prototype.IsMovingInDirection=function(a){return this._moving[a]||
!1};c.prototype.StartMoving=function(a){this.Move(a,!0)};c.prototype.StopMoving=function(a){this.Move(a,!1)};c.prototype.MoveSpeed=function(a){"undefined"!==typeof a&&(this._moveSpeed=a,this._velocityUpdater());return this._moveSpeed};c.prototype.Update=function(b){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(b.Elapsed.Seconds)),a.prototype.Update.call(this,b))};c.prototype.Move=function(a,b){if("undefined"!==typeof this._moving[a])this._moving[a]=b,this._velocityUpdater(),
this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:a,StartMoving:b});else throw Error(a+" is an unknown direction.");};c.prototype.UpdateVelocityNoMultiDirection=function(){var a=b.Vector2d.Zero;a.IsZero()&&(this._moving.Up&&(a.Y-=this._moveSpeed),this._moving.Down&&(a.Y+=this._moveSpeed),0===a.Y&&(this._moving.Left&&(a.X-=this._moveSpeed),this._moving.Right&&(a.X+=this._moveSpeed)));this.Velocity=a};c.prototype.UpdateVelocityWithMultiDirection=function(){var a=b.Vector2d.Zero;this._moving.Up&&
(a.Y-=this._moveSpeed);this._moving.Down&&(a.Y+=this._moveSpeed);this._moving.Left&&(a.X-=this._moveSpeed);this._moving.Right&&(a.X+=this._moveSpeed);this.Velocity=a};c.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))};return c}(b.MovementControllers.MovementController);f.LinearMovementController=d})(b.MovementControllers||(b.MovementControllers={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,e,d,f,g,q){"undefined"===typeof d&&(d=["w","Up"]);"undefined"===typeof f&&(f=["d","Right"]);"undefined"===typeof g&&(g=["s","Down"]);"undefined"===typeof q&&(q=["a","Left"]);this._keyboard=a;this._onMove=e;this._directions=new b.MovementControllers.Assets.LinearDirections;this.BindKeys(d,"OnCommandDown","Up",!0);this.BindKeys(f,"OnCommandDown","Right",!0);this.BindKeys(g,"OnCommandDown","Down",!0);this.BindKeys(q,"OnCommandDown","Left",!0);this.BindKeys(d,
"OnCommandUp","Up",!1);this.BindKeys(f,"OnCommandUp","Right",!1);this.BindKeys(g,"OnCommandUp","Down",!1);this.BindKeys(q,"OnCommandUp","Left",!1)}a.prototype.BindKeys=function(a,b,d,f){for(var g=this,q=0;q<a.length;q++)this._keyboard[b](a[q],function(){g._directions[d]!=f&&(g._directions[d]=f,g._onMove(d,f))})};return a}();f.DirectionalInputController=d})(b.InputControllers||(b.InputControllers={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d){var f=this;a.call(this,c);this._type="Shape";this._fillChangeWire=function(a){f._State.FillStyle=a.toString()};this._strokeChangeWire=function(a){f._State.StrokeStyle=a.toString()};this._shadowChangeWire=function(a){f._State.ShadowColor=a.toString()};this.BorderColor=this._strokeStyle=this.ShadowColor=this._shadowColor=b.Graphics.Color.Black;"undefined"!==typeof d?("string"===typeof d&&(d=new b.Graphics.Color(d)),this.Color=this._fillStyle=
d):this.Color=this._fillStyle=b.Graphics.Color.Black}__extends(c,a);Object.defineProperty(c.prototype,"Color",{get:function(){return this._fillStyle},set:function(a){"string"===typeof a&&(a=new b.Graphics.Color(a));this._fillStyle.OnChange.Unbind(this._fillChangeWire);this._fillStyle=a;this._fillStyle.OnChange.Bind(this._fillChangeWire);this._fillChangeWire(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(a){this._State.LineWidth=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"BorderColor",{get:function(){return this._strokeStyle},set:function(a){"string"===typeof a&&(a=new b.Graphics.Color(a));this._strokeStyle.OnChange.Unbind(this._strokeChangeWire);this._strokeStyle=a;this._strokeStyle.OnChange.Bind(this._strokeChangeWire);this._strokeChangeWire(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowColor",{get:function(){return this._shadowColor},set:function(a){"string"===typeof a&&
(a=new b.Graphics.Color(a));this._shadowColor.OnChange.Unbind(this._shadowChangeWire);this._shadowColor=a;this._shadowColor.OnChange.Bind(this._shadowChangeWire);this._shadowChangeWire(a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(a){this._State.ShadowOffsetX=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(a){this._State.ShadowOffsetY=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(a){this._State.ShadowBlur=a},enumerable:!0,configurable:!0});c.prototype.Border=function(a,b){this.BorderThickness=a;this.BorderColor=b};c.prototype.Shadow=function(a,b,c,d){this.ShadowX=a;this.ShadowY=b;this.ShadowColor=c;this.ShadowBlur=d};c.prototype._StartDraw=function(b){a.prototype._StartDraw.call(this,b);b.beginPath()};c.prototype._EndDraw=function(b){b.fill();
0<this._State.LineWidth?b.stroke():b.closePath();a.prototype._EndDraw.call(this,b)};c.prototype._BuildPath=function(a){};c.prototype.Draw=function(a){this._StartDraw(a);this._BuildPath(a);this._EndDraw(a)};c.prototype.Dispose=function(){a.prototype.Dispose.call(this);this._fillStyle.OnChange.Unbind(this._fillChangeWire);this._strokeStyle.OnChange.Unbind(this._strokeChangeWire);this._shadowColor.OnChange.Unbind(this._shadowChangeWire)};c.prototype._Clone=function(b){b.Border(this.BorderThickness,this.BorderColor.Clone());
b.Shadow(this.ShadowX,this.ShadowY,this.ShadowColor.Clone(),this.ShadowBlur);a.prototype._Clone.call(this,b)};return c}(b.Graphics.Graphic2d);f.Shape=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){b=b.Graphics||(b.Graphics={});b=b.Assets||(b.Assets={});b=b.FontFamily||(b.FontFamily={});b[b.Antiqua=0]="Antiqua";b[b.Arial=1]="Arial";b[b.Avqest=2]="Avqest";b[b.Blackletter=3]="Blackletter";b[b.Calibri=4]="Calibri";b[b.ComicSans=5]="ComicSans";b[b.Courier=6]="Courier";b[b.Decorative=7]="Decorative";b[b.Fraktur=8]="Fraktur";b[b.Frosty=9]="Frosty";b[b.Garamond=10]="Garamond";b[b.Georgia=11]="Georgia";b[b.Helvetica=12]="Helvetica";b[b.Impact=13]="Impact";b[b.Minion=14]="Minion";b[b.Modern=
15]="Modern";b[b.Monospace=16]="Monospace";b[b.Palatino=17]="Palatino";b[b.Roman=18]="Roman";b[b.Script=19]="Script";b[b.Swiss=20]="Swiss";b[b.TimesNewRoman=21]="TimesNewRoman";b[b.Verdana=22]="Verdana"})(EndGate||(EndGate={}));(function(b){b=b.Graphics||(b.Graphics={});b=b.Assets||(b.Assets={});b=b.FontVariant||(b.FontVariant={});b[b.Normal=0]="Normal";b[b.SmallCaps=1]="SmallCaps"})(EndGate||(EndGate={}));
(function(b){b=b.Graphics||(b.Graphics={});b=b.Assets||(b.Assets={});b=b.FontStyle||(b.FontStyle={});b[b.Normal=0]="Normal";b[b.Italic=1]="Italic";b[b.Oblique=2]="Oblique"})(EndGate||(EndGate={}));
(function(b){(function(f){(function(d){var a=function(){function a(){this._cachedState={fontSize:"10px",fontFamily:21,fontVariant:0,fontWeight:"",fontStyle:0};this._refreshCache=!0;this._BuildFont()}Object.defineProperty(a.prototype,"FontSize",{get:function(){return this._cachedState.fontSize},set:function(a){this._refreshCache=!0;this._cachedState.fontSize=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"FontFamily",{get:function(){return this._cachedState.fontFamily},set:function(a){this._refreshCache=
!0;this._cachedState.fontFamily=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"FontVariant",{get:function(){return this._cachedState.fontVariant},set:function(a){this._refreshCache=!0;this._cachedState.fontVariant=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"FontWeight",{get:function(){return this._cachedState.fontWeight},set:function(a){this._refreshCache=!0;this._cachedState.fontWeight=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"FontStyle",{get:function(){return this._cachedState.fontStyle},set:function(a){this._refreshCache=!0;this._cachedState.fontStyle=a},enumerable:!0,configurable:!0});a.prototype._BuildFont=function(){var a;this._refreshCache&&(a=this._cachedState.fontWeight+" "+b.Graphics.Assets.FontStyle[this._cachedState.fontStyle].replace("Normal","")+" "+b.Graphics.Assets.FontVariant[this._cachedState.fontVariant].replace("Normal","")+" "+this._cachedState.fontSize,void 0!==this._cachedState.fontFamily&&(a+=" "+
b.Graphics.Assets.FontFamily[this._cachedState.fontFamily]),this._cachedFont=a.replace(/^\s\s*/,"").replace(/\s\s*$/,""),this._refreshCache=!1);return this._cachedFont};return a}();d.FontSettings=a})(f.Assets||(f.Assets={}))})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d,f,g){"undefined"===typeof g&&(g=b.Graphics.Color.Black);a.call(this,new b.Vector2d(c,d),g);this._type="Text2d";this._text=f;this._drawBounds=new b.Bounds.BoundingRectangle(this.Position,b.Size2d.One);this._recalculateBoundsSize=!0;this._fontSettings=new b.Graphics.Assets.FontSettings;this.Align="center";this.Baseline="middle"}__extends(c,a);Object.defineProperty(c.prototype,"Align",{get:function(){return this._State.TextAlign},set:function(a){this._State.TextAlign=
a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Baseline",{get:function(){return this._State.TextBaseline},set:function(a){this._State.TextBaseline=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"FontSettings",{get:function(){this._recalculateBoundsSize=!0;return this._fontSettings},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"Text",{get:function(){return this._text},set:function(a){this._recalculateBoundsSize=!0;this._text=a},enumerable:!0,
configurable:!0});c.prototype._StartDraw=function(a){a.save();this._State.SetContextState(a);a.translate(this.Position.X,this.Position.Y);0!==this.Rotation&&a.rotate(this.Rotation)};c.prototype._EndDraw=function(a){for(var b=this.GetChildren(),c=0;c<b.length;c++)b[c].Visible&&b[c].Draw(a);a.restore()};c.prototype.Draw=function(a){var b;this._State.Font=this._fontSettings._BuildFont();this._StartDraw(a);a.fillText(this._text,0,0);0<this._State.LineWidth&&a.strokeText(this._text,0,0);this._recalculateBoundsSize&&
(this._recalculateBoundsSize=!1,b=a.measureText(this._text),this._drawBounds.Size.Width=b.width,this._drawBounds.Size.Height=1.5*parseInt(this._fontSettings.FontSize));this._EndDraw(a)};c.prototype.GetDrawBounds=function(){this._drawBounds.Rotation=this.Rotation;this._drawBounds.Position=this.Position;return this._drawBounds};c.prototype.Scale=function(a){var b=parseInt(this.FontSettings.FontSize);this.FontSettings.FontSize=this.FontSettings.FontSize.replace(b.toString(),(b*a).toString())};c.prototype.Clone=
function(){var b=new c(this.Position.X,this.Position.Y,this.Text,this.Color.Clone());b.Align=this.Align;b.Baseline=this.Baseline;b.FontSettings.FontFamily=this.FontSettings.FontFamily;b.FontSettings.FontSize=this.FontSettings.FontSize;b.FontSettings.FontStyle=this.FontSettings.FontStyle;b.FontSettings.FontVariant=this.FontSettings.FontVariant;b.FontSettings.FontWeight=this.FontSettings.FontWeight;a.prototype._Clone.call(this,b);return b};return c}(b.Graphics.Shape);f.Text2d=d})(b.Graphics||(b.Graphics=
{}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(){function a(a,d,f,h,g){"undefined"===typeof g&&(g=b.Vector2d.Zero);var q=this;this._imageSource=a;this._frameSize=f;this._frameCount=h;this._startOffset=g;this._repeating=this._playing=!1;this._lastStepAt=this._currentFrame=0;this._onComplete=new b.EventHandler;this.Fps=d;null!==a.ClipSize||a.IsLoaded()?(this._framesPerRow=Math.min(Math.floor((a.Size.Width-g.X)/f.Width),h),this.UpdateImageSource()):(a.OnLoaded.BindFor(function(b){q._framesPerRow=Math.min(Math.floor((a.Size.Width-
g.X)/f.Width),h);q.UpdateImageSource()},1),this._framesPerRow=1)}Object.defineProperty(a.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"Fps",{get:function(){return this._fps},set:function(a){this._fps=a;this._stepEvery=1E3/this._fps},enumerable:!0,configurable:!0});a.prototype.IsPlaying=function(){return this._playing};a.prototype.CanPlay=function(){return this._imageSource.IsLoaded()};a.prototype.Play=function(a){"undefined"===
typeof a&&(a=!1);if(!this._imageSource.ClipSize)throw Error("Image source not loaded yet.");this._lastStepAt=(new Date).getTime();this._repeating=a;this._playing=!0;this.UpdateImageSource()};a.prototype.Pause=function(){this._playing=!1};a.prototype.Step=function(a){"undefined"===typeof a&&(a=1);this._currentFrame+=a;this._currentFrame>=this._frameCount&&(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1)));0!==a&&this.UpdateImageSource()};
a.prototype.Stop=function(a){"undefined"===typeof a&&(a=!0);this._playing=!1;a&&this.Reset()};a.prototype.Reset=function(){this._currentFrame=0;this.UpdateImageSource()};a.prototype.Update=function(a){var b=a.Now.getTime()-this._lastStepAt,d=0;this._playing&&(d=Math.floor(b/this._stepEvery),0<d&&(this._lastStepAt=a.Now.getTime(),this.Step(d)))};a.prototype.Dispose=function(){this._onComplete.Dispose()};a.prototype.UpdateImageSource=function(){var a=this.GetFrameRow(),b=this.GetFrameColumn();this._imageSource.ClipLocation.X=
this._startOffset.X+b*this._frameSize.Width;this._imageSource.ClipLocation.Y=this._startOffset.Y+a*this._frameSize.Height;this._imageSource.ClipSize=this._frameSize};a.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)};a.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)};return a}();f.SpriteAnimation=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d,f,g){a.call(this,new b.Vector2d(c,d),g);this._type="Circle";this.Radius=f}__extends(c,a);c.prototype.GetDrawBounds=function(){var a=new b.Bounds.BoundingCircle(this.Position,this.Radius);a.Rotation=this.Rotation;return a};c.prototype.Scale=function(a){this.Radius*=a};c.prototype.Clone=function(){var b=new c(this.Position.X,this.Position.Y,this.Radius,this.Color.Clone());a.prototype._Clone.call(this,b);return b};c.prototype._BuildPath=function(a){a.arc(0,
0,this.Radius,0,Math.twoPI)};return c}(b.Graphics.Shape);f.Circle=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){(function(f){var d=function(a){function c(c,d,f,g,q){a.call(this,new b.Vector2d(c,d),q);this._type="Rectangle";this.Size=new b.Size2d(f,g)}__extends(c,a);c.prototype.GetDrawBounds=function(){var a=new b.Bounds.BoundingRectangle(this.Position,this.Size);a.Rotation=this.Rotation;return a};c.prototype.Scale=function(a){this.Size.Width*=a;this.Size.Height*=a};c.prototype.Clone=function(){var b=new c(this.Position.X,this.Position.Y,this.Size.Width,this.Size.Height,this.Color.Clone());a.prototype._Clone.call(this,
b);return b};c.prototype._BuildPath=function(a){a.rect(-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height)};return c}(b.Graphics.Shape);f.Rectangle=d})(b.Graphics||(b.Graphics={}))})(EndGate||(EndGate={}));
(function(b){var f=function(){function d(a,b,d,f){"undefined"===typeof a&&(a=0);"undefined"===typeof b&&(b=0);"undefined"===typeof d&&(d=0);"undefined"===typeof f&&(f=0);this._type="Matrix2x2";this.Values=[[a,b],[d,f]]}Object.defineProperty(d,"Zero",{get:function(){return new d},enumerable:!0,configurable:!0});Object.defineProperty(d,"Identity",{get:function(){return new d(1,0,0,1)},enumerable:!0,configurable:!0});d.prototype.Apply=function(a){this.Values[0][0]=a(this.Values[0][0]);this.Values[0][1]=
a(this.Values[0][1]);this.Values[1][0]=a(this.Values[1][0]);this.Values[1][1]=a(this.Values[1][1])};d.prototype.Trigger=function(a){a(this.Values[0][0]);a(this.Values[0][1]);a(this.Values[1][0]);a(this.Values[1][1])};d.prototype.Add=function(a){return"Matrix2x2"===a._type?new d(this.Values[0][0]+a.Values[0][0],this.Values[0][1]+a.Values[0][1],this.Values[1][0]+a.Values[1][0],this.Values[1][1]+a.Values[1][1]):new d(this.Values[0][0]+a,this.Values[0][1]+a,this.Values[1][0]+a,this.Values[1][1]+a)};d.prototype.Multiply=
function(a){return"Matrix2x2"===a._type?new d(this.Values[0][0]*a.Values[0][0]+this.Values[0][1]*a.Values[1][0],this.Values[0][0]*a.Values[0][1]+this.Values[0][1]*a.Values[1][1],this.Values[1][0]*a.Values[0][0]+this.Values[1][1]*a.Values[1][0],this.Values[1][0]*a.Values[0][1]+this.Values[1][1]*a.Values[1][1]):new d(this.Values[0][0]*a,this.Values[0][1]*a,this.Values[1][0]*a,this.Values[1][1]*a)};d.prototype.Subtract=function(a){return"Matrix2x2"===a._type?new d(this.Values[0][0]-a.Values[0][0],this.Values[0][1]-
a.Values[0][1],this.Values[1][0]-a.Values[1][0],this.Values[1][1]-a.Values[1][1]):new d(this.Values[0][0]-a,this.Values[0][1]-a,this.Values[1][0]-a,this.Values[1][1]-a)};d.prototype.SubtractFrom=function(a){return"Matrix2x2"===a._type?new d(a.Values[0][0]-this.Values[0][0],a.Values[0][1]-this.Values[0][1],a.Values[1][0]-this.Values[1][0],a.Values[1][1]-this.Values[1][1]):new d(a-this.Values[0][0],a-this.Values[0][1],a-this.Values[1][0],a-this.Values[1][1])};d.prototype.Divide=function(a){return"Matrix2x2"===
a._type?new d(this.Values[0][0]/a.Values[0][0],this.Values[0][1]/a.Values[0][1],this.Values[1][0]/a.Values[1][0],this.Values[1][1]/a.Values[1][1]):new d(this.Values[0][0]/a,this.Values[0][1]/a,this.Values[1][0]/a,this.Values[1][1]/a)};d.prototype.DivideFrom=function(a){return"Matrix2x2"===a._type?new d(a.Values[0][0]/this.Values[0][0],a.Values[0][1]/this.Values[0][1],a.Values[1][0]/this.Values[1][0],a.Values[1][1]/this.Values[1][1]):new d(a/this.Values[0][0],a/this.Values[0][1],a/this.Values[1][0],
a/this.Values[1][1])};d.prototype.Transform=function(a){return new b.Vector2d(this.Values[0][0]*a.X+this.Values[0][1]*a.Y,this.Values[1][0]*a.X+this.Values[1][1]*a.Y)};d.prototype.Transpose=function(){return new d(this.Values[0][0],this.Values[1][0],this.Values[0][1],this.Values[1][1])};d.prototype.Determinant=function(){return this.Values[0][0]*this.Values[1][1]-this.Values[0][1]*this.Values[1][0]};d.prototype.Inverse=function(){return(new d(this.Values[1][1],-this.Values[0][1],-this.Values[1][0],
this.Values[0][0])).Multiply(1/this.Determinant())};d.prototype.Clone=function(){return new d(this.Values[0][0],this.Values[0][1],this.Values[1][0],this.Values[1][1])};d.prototype.Equivalent=function(a){return this.Values[0][0]===a.Values[0][0]&&this.Values[0][1]===a.Values[0][1]&&this.Values[1][0]===a.Values[1][0]&&this.Values[1][1]===a.Values[1][1]};d.prototype.toString=function(){return this.Values[0].toString()+" "+this.Values[1].toString()};d.Scale=function(a){return new d(a.X,0,0,a.Y)};return d}();
b.Matrix2x2=f})(EndGate||(EndGate={}));var eg=EndGate;
(function(b){var f=function(){function b(){this._type="EventHandler3";this._actions=[]}b.prototype.Bind=function(a){this._actions.push(a)};b.prototype.BindFor=function(a,b){var d=this,f=0,h=function(){++f>=b&&d.Unbind(h);a.apply(this,arguments)};this._actions.push(h)};b.prototype.Unbind=function(a){for(var b=0;b<this._actions.length;b++)if(this._actions[b]===a){this._actions.splice(b,1);break}};b.prototype.HasBindings=function(){return 0<this._actions.length};b.prototype.Trigger=function(a,b,d){var f;
if(this.HasBindings()){f=this._actions.slice(0);for(var h=0;h<f.length;h++)f[h](a,b,d)}};b.prototype.Dispose=function(){this._actions=[]};return b}();b.EventHandler3=f})(EndGate||(EndGate={}));
